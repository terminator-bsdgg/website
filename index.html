<!DOCTYPE html>
<html lang="de">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="verdammt">
        <meta name="keywords" content="lol,wtf">
        <meta name="copyright" content="BSDGG/IN20/FIAE">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>STARTSEITE || TERMINATOR</title>
        <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="css/dataTables.bootstrap5.min.css">
        <link rel="stylesheet" type="text/css" href="css/bootstrap-datetimepicker.min.css">
        <link rel="stylesheet" type="text/css" href="css/fontawesome.min.css">
        <link rel="stylesheet" type="text/css" href="css/solid.min.css">
        <link rel="stylesheet" type="text/css" href="css/regular.min.css">
        <link rel="stylesheet" type="text/css" href="css/fullcalendar.min.css">
        <script src="js/jquery-3.6.0.min.js"></script>
        <script src="js/bootstrap.bundle.min.js"></script>
        <script src="js/datatables.min.js"></script>
        <script src="js/dataTables.bootstrap5.min.js"></script>
        <script src="js/litepicker.js"></script>
        <script src="js/fullcalendar.min.js"></script>
        <script src="js/fullcalendar-locales/de.js"></script>
        <script src="js/fullcalendar-locales/en-gb.js"></script>
        <style>
            body {
                display: grid;
                grid-gap: 0;
                grid-template-rows: auto 1fr 71px;
                overflow-x: hidden;
                min-height: 100vh; 
                background-color: #002e4d0d;
                align-content: flex-start;
            }
            #body-overlay {
                position: absolute;
                z-index: 9999;
                width: 100%;
                height: 100%;
                opacity: 1;
                background-color: #ffffff;
                transition: opacity 1s;
                display: flex;
                align-content: center;
                align-items: center;
                justify-content: center;
            }
            #body-overlay > h1 {
                color: var(--bs-gray-500, #adb5bd);
                margin: 0
            }
            header {
                grid-column: 1 / 3;
                grid-row: 1 / 1;
                display: flex;
                flex-direction: column;
                align-self: flex-start;
                background-color: #024471;
                height: 50px;
                color: #fff;
                justify-content: center;
            }
            footer {
                height: 50px;
                color: white; 
                grid-column: 1 / 3;
                grid-row: 3 / 3;
                align-self: flex-end;
                background-color: #024471;
                text-shadow: 0 1px 0 black;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            main {
                grid-column: 1 / 3;
                grid-row: 2 / 2;
                display: flex;
                align-items: flex-start;
                justify-content: center;
                padding: 0 2%;
            }
            main > div.row:first-of-type {
                flex: 0 1 100%
            }
            #mobile-navbar {
                display: block;
                margin: auto 20px auto auto;
            }
            ul.dropdown-menu {
                box-shadow: 0 0 5px 1px #0000008a
            }
            .tab-content:not(.tab-content-simple) {
                background-color: #fcfbfa;
                box-shadow: 0 2px 5px 0px #00000057;
                border-left: 1px solid var(--bs-gray-300);
                border-right: 1px solid var(--bs-gray-300);
                border-bottom: 1px solid var(--bs-gray-300);
                border-bottom-left-radius: 5px;
                border-bottom-right-radius: 5px;
                border-top-right-radius: 5px;
            }
            .navbar-nav > .nav-item > .nav-link, .navbar-nav > .nav-item > .nav-link:hover, .navbar-nav > .nav-item > .nav-link:focus, .navbar-nav > .nav-item > .nav-link:visited, .navbar-nav > .nav-item >  .nav-link:active {
                color: white;
                background-color: transparent;
                transition: background-color 200ms linear 0s;
                text-shadow: 0 1px 0 black;
            }
            .navbar-nav > .nav-item > .nav-link:hover, .navbar-nav > .nav-item > .nav-link:active {
                background-color: white;
                color: black;
                box-shadow: 0 1px 1px 0px rgba(0, 0, 0, 0.5);
                text-shadow: 0 1px 0 transparent;
            }
            .nav-tabs > .nav-item > .nav-link:focus-visible, .nav-pills > .nav-item > .nav-link:focus-visible, .navbar-nav > .nav-item > .nav-link:focus-visible {
                outline-style: none;
            }
            .nav-tabs > .nav-item {
                z-index: 2;
            }
            .nav-tabs {
                border-bottom-width: 0 !important;
            }
            .nav-tabs > .nav-item {
                position: relative
            }
            a[data-bs-toggle="pill"]:hover {
                background-color: rgba(var(--bs-primary-rgb), 0.1);
            }
            /* langer block unter erstem tab */
            .nav-tabs > .nav-item:first-of-type > .nav-link.active::after {
                content: "";
                position: absolute;
                width: 100%;
                height: 10px;
                left: -1px;
                bottom: -10px;
                z-index: 10;
                background-color: #fcfbfa;
                border-left: 1px solid #e2e5e8;
            }
            /* kleine blöcke VOR erstem tab */
            .nav-tabs > .nav-item:not(:first-of-type)::before {
                content: "";
                position: absolute;
                width: 10px;
                height: 10px;
                left: -5px;
                bottom: -10px;
                z-index: 11;
                background-color: #fcfbfa;
            }
            /* langer block unter nicht erstem tab */
            .nav-tabs > .nav-item:not(:first-of-type) > .nav-link.active::after {
                content: "";
                position: absolute;
                width: 100%;
                height: 10px;
                left: -1px;
                bottom: -10px;
                z-index: 10;
                background-color: #fcfbfa;
            }
            /* kleiner block HINTER letztem tab */
            .nav-tabs > .nav-item:last-of-type::after {
                content: "";
                position: absolute;
                width: 10px;
                height: 10px;
                right: -5px;
                bottom: -10px;
                z-index: 11;
                background-color: #fcfbfa;
            }
            .nav-tabs > .nav-item > .nav-link.active {
                box-shadow: 0 2px 5px 0px #00000057;
                background-color: #fcfbfa;
                border-bottom-color: #fcfbfa;
                position: relative;
            }
            .nav-tabs > .nav-item > .nav-link.disabled {
                border: 1px solid var(--bs-gray-200, #e9ecef) !important;
            }
            .nav-tabs > .nav-item > a.nav-link:not(.disabled, .active):hover, .nav-tabs > .nav-item > a.nav-link:not(.disabled, .active):active,
            .nav-tabs > .nav-item > a.nav-link:not(.disabled, .active):focus {
                border: 1px solid var(--bs-gray-300, #dee2e6) !important;
                border-bottom: 1px solid transparent !important
            }
            table:not(.table-borderless) > thead > tr > th:first-of-type {
                border-top-left-radius: 2px;
            }
            table:not(.table-borderless) > thead > tr > th:last-of-type {
                border-top-right-radius: 2px;
            }
            table:not(.table-borderless) > thead > tr > th:not(.TintengefrorenerTiefenfrisch) {
                border-left: 1px solid var(--bs-gray-300, #dee2e6) !important;
            }
            table:not(.table-borderless) > thead > tr > th {
                border-top: 1px solid var(--bs-gray-300, #dee2e6) !important;
                border-bottom: 2px solid var(--bs-gray-300, #dee2e6) !important;
                background-color: #f7f7f7 !important
            }
            table:not(.table-borderless) > thead > tr > th:last-of-type {
                border-right: 1px solid var(--bs-gray-300, #dee2e6) !important;
            }
            table.dataTable:not(.table-borderless) > thead > tr > th:last-of-type {
                border-right: 1px solid var(--bs-gray-300, #dee2e6) !important
            }
            table.dataTable:not(.table-borderless) > tbody > tr > td:not(.fritz) {
                border-left: 1px solid var(--bs-gray-300, #dee2e6) !important
            }
            table.dataTable:not(.table-borderless) > tbody > tr:last-of-type > td {
                border-bottom: 1px solid var(--bs-gray-300, #dee2e6) !important
            }
            table.dataTable:not(.table-borderless) > tbody > tr:last-of-type > td:first-of-type {
                border-bottom-left-radius: 2px
            }
            table.dataTable:not(.table-borderless) > tbody > tr:last-of-type > td:last-of-type {
                border-bottom-right-radius: 2px
            }
            /* Normale Tabellen */
            table:not(.table-borderless, .dataTable) > tbody > tr > td:last-of-type {
                border-right: 1px solid var(--bs-gray-300, #dee2e6)
            }
            table:not(.table-borderless, .dataTable) > tbody > tr > td {
                border-bottom: 1px solid var(--bs-gray-300, #dee2e6);
                border-left: 1px solid var(--bs-gray-300, #dee2e6)
            }
            table.dataTable > thead .sorting::before, table.dataTable > thead .sorting_asc::before, 
            table.dataTable > thead .sorting_desc::before, table.dataTable > thead .sorting_asc_disabled::before, 
            table.dataTable > thead .sorting_desc_disabled::before,
            table.dataTable > thead .sorting::after, table.dataTable > thead .sorting_asc::after,
            table.dataTable > thead .sorting_desc::after, table.dataTable > thead .sorting_asc_disabled::after,
            table.dataTable > thead .sorting_desc_disabled::after {
                content: "" !important;
                right: auto !important
            }
            table.dataTable thead .sorting::after {
                position: absolute;
                width: 100%;
                height: 100%;
                right: 5px !important;
                top: 0 !important;
                opacity: 0.5 !important;
                background-repeat: no-repeat;
                background-position-x: right;
                background-position-y: center;
                background-size: 16px 16px;
                background-image: url("img/iconmonstr-sort-2.svg")
            }
            table.dataTable thead .sorting_desc::after {
                background-image: url("img/iconmonstr-sort-3.svg") !important
            }
            table.dataTable thead .sorting_asc::after {
                background-image: url("img/iconmonstr-sort-4.svg") !important
            }
            table > tbody > tr {
                vertical-align: middle;
            }
            div.dataTables_scrollHeadInner {
                padding-right: 0 !important;
                width: 100% !important
            }
            table.dataTable:not(.table-borderless) > tbody > tr > td:only-of-type, table.dataTable:not(.table-borderless) > tbody > tr > td:last-of-type {
                border-right: 1px solid var(--bs-gray-300, #dee2e6);
            }
            table.dataTable > thead > tr > th {
                box-sizing: border-box;
            }
            footer a, footer a:hover {
                border-bottom: 1px dotted #ffffff;
                text-decoration: none;
                color: #ffffff;
            }
            /* Vorladen von Sortierungssymbolen in Tabellen */
            body::after {
                position: absolute;
                width: 0;
                height: 0;
                z-index: -1;
                overflow: hidden;
                content: url("img/iconmonstr-sort-2.svg") url("img/iconmonstr-sort-3.svg") url("img/iconmonstr-sort-4.svg")
            }
            .alert-primary.alertBoxContainer {
                border-color: #b1cbf5
            }
            .alert-warning.alertBoxContainer {
                border-color: #ebde9f
            }
            .alert-danger.alertBoxContainer {
                border-color: #e5babe
            }
            .alert-success.alertBoxContainer {
                border-color: #b9dac1
            }
            .alertBoxIcon {
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 0.714rem 0.357rem;
                align-self: stretch;
            }
            .alertBoxIcon.primary {
                background-color: #b1cbf5;
                color: #437b95
            }
            .alertBoxIcon.danger {
                background-color: #e5babe;
                color: #911
            }
            .alertBoxIcon.success {
                background-color: #b9dac1;
                color: #508d50
            }
            .alertBoxIcon.warning {
                background-color: #ebde9f;
                color: #918130
            }
            .alertBoxIcon > i {
                font-size: 1.5625rem
            }
            .alertBoxText {
                padding: 0.5rem;
                margin: 0.5rem;
                width: 100%;
            }
            #logo {
                background-image: url("img/termiconator.png");
                background-repeat: no-repeat;
                background-size: 41px 49px;
                background-position: "top left";
                width: 41px;
                height: 49px;
            }
            .alertBoxContainer {
                display: flex;
                align-items: center;
                padding: 0;
                position: relative
            }
            .alertBoxText button.close {
                margin: 0 0 auto auto;
            }
            .alertBoxText ul {
                list-style-position: inside;
                margin: 0;
                padding: 0;
            }
            .table-container {
                flex: 1 0 auto;
                overflow-y: auto;
                width: 0;
            }
            .bg-gray-200 {
                background-color: var(--bs-gray-200, #e9ecef);
                font-weight: 600;
            }
            .time-picker {
                box-shadow: 0 0 3px 0 #0000006e;
                background-color: white;
                position: absolute;
                z-index: 1100
            }
            .time-picker::after {
                content: "";
                position: absolute;
                left: 5px;
                bottom: -6px;
                width: 0;
	            height: 0;
	            border-left: 6px solid transparent;
	            border-right: 6px solid transparent;
	            border-top: 6px solid white;
                z-index: 0;
                filter: drop-shadow(0px 0px 3px #0000006e)
            }
            .kreiselchen {
                width: 1.25rem;
                height: 1.25rem
            }
            .cursor-pointer:hover {
                cursor: pointer
            }
            @media only screen and (max-width: 600px) {
                .alert > i {
                    vertical-align: baseline !important;
                }
                main {
                    padding: 0 2%
                }
                table.dataTable thead > tr > th {
                    font-weight: 600;
                }
                #first-navbar, #second-navbar {
                    display: none;
                }
                #mobile-navbar {
                    display: block;
                    margin: auto 20px auto auto;
                }
                .formContainer {
                    flex-direction: column;
                }
                .formContainer > label + select:not(:last-child), .formContainer > label + input:not(:last-child), .formContainer > button:not(:last-child) {
                    margin-bottom: 0.5rem;
                }
                table.dataTable:not(.table-borderless) > tbody > tr:first-of-type > td:first-of-type {
                    border-top-left-radius: 1px;
                    border-top-right-radius: 1px;
                    overflow: hidden;
                }
                *:not(h1, h2, h3, h4, h5, h6, .alertBoxIcon > i, h1 > span, h2 > span, h3 > span, h4 > span, h5 > span, h6 > span, h1 > i, h2 > i, h3 > i, h4 > i, h5 > i, h6 > i) {
                    font-size: 14px !important;
                }
                .dataTables_filter {
                    margin-top: 0.5rem;
                }
                .table-container {
                    width: 0;
                    flex: 1 0 auto;
                    overflow-y: auto
                }
            }
            @media only screen and (min-width: 600px) {
                .alert > i {
                    vertical-align: baseline !important;
                }
                main {
                    padding: 0 2%
                }
                table.dataTable thead > tr > th {
                    font-weight: 600;
                }
                #first-navbar, #second-navbar {
                    display: none;
                }
                #mobile-navbar {
                    display: block;
                    margin: auto 20px auto auto;
                }
                .formContainer {
                    flex-direction: column;
                }
                .formContainer > label + select:not(:last-child), .formContainer > label + input:not(:last-child), .formContainer > button:not(:last-child) {
                    margin-bottom: 0.5rem;
                }
                table.dataTable:not(.table-borderless) > tbody > tr:first-of-type > td:first-of-type {
                    border-top-left-radius: 1px;
                    border-top-right-radius: 1px;
                    overflow: hidden;
                }
                *:not(h1, h2, h3, h4, h5, h6, .alertBoxIcon > i, h1 > span, h2 > span, h3 > span, h4 > span, h5 > span, h6 > span, h1 > i, h2 > i, h3 > i, h4 > i, h5 > i, h6 > i) {
                    font-size: 14px !important;
                }
                .dataTables_filter {
                    margin-top: 0.5rem;
                }
                .table-container {
                    width: 0;
                    flex: 1 0 auto;
                    overflow-y: auto
                }
                #reservationCalendar {
                    margin-bottom: 1rem;
                }
            }
            @media only screen and (min-width: 768px) {
                #first-navbar, #second-navbar {
                    display: flex;
                }
                #mobile-navbar {
                    display: none;
                }
                *:not(h1, h2, h3, h4, h5, h6, .alertBoxIcon > i, h1 > span, h2 > span, h3 > span, h4 > span, h5 > span, h6 > span, h1 > i, h2 > i, h3 > i, h4 > i, h5 > i, h6 > i) {
                    font-size: 14px !important;
                }
                .formContainer > label + select:not(:last-child), .formContainer > button:not(:last-child) {
                    margin-bottom: 0.5rem;
                }
                #reservationCalendar {
                    margin-bottom: 0;
                }
            }
            @media only screen and (min-width: 992px) {
                #first-navbar, #second-navbar {
                    display: flex;
                }
                .formContainer {
                    flex-direction: row;
                    align-content: center;
                    align-items: center;
                }
                .formContainer > * {
                    margin-top: 0;
                    margin-bottom: 0 !important;
                }
                .formContainer label:not(:first-of-type) {
                    margin-left: 1rem;
                }
                .formContainer button:not(:only-child) {
                    margin-left: 0.5rem;
                }
                #mobile-navbar {
                    display: none;
                }
                *:not(h1, h2, h3, h4, h5, h6, .alertBoxIcon > i, h1 > span, h2 > span, h3 > span, h4 > span, h5 > span, h6 > span, h1 > i, h2 > i, h3 > i, h4 > i, h5 > i, h6 > i) {
                    font-size: 16px !important;
                }
                #reservationCalendar {
                    margin-bottom: 0;
                }
            }
            @media only screen and (min-width: 1200px) {
                #first-navbar, #second-navbar {
                    display: flex;
                }
                #mobile-navbar {
                    display: none;
                }
                *:not(h1, h2, h3, h4, h5, h6, .alertBoxIcon > i, h1 > span, h2 > span, h3 > span, h4 > span, h5 > span, h6 > span, h1 > i, h2 > i, h3 > i, h4 > i, h5 > i, h6 > i) {
                    font-size: 16px !important;
                }
                .formContainer > * {
                    margin-top: 0;
                    margin-bottom: 0;
                }
                .formContainer label:not(:first-of-type) {
                    margin-left: 1rem;
                }
                .formContainer button:not(:only-child) {
                    margin-left: 0.5rem;
                }
                #reservationCalendar {
                    margin-bottom: 0;
                }
            }
        </style>
        <script>
            /*
            TODO:
            -rowGroup mit richtigen Namen versehen
            -Datumsauswahl im Kalender so anpassen, dass auch der aktuelle Tag ausgewählt werden kann
            -Spaltensortierung in Logs (data.order!)
            -Enddatum neuer Reservierungen muss bei Auswahl eines einzigen Tages gleich des Startdatums sein
            -Eigene Reservierungen!
            */
            var systemInfosTimer = null;
            var isLoadingSystemInfos = false;
            var viewportWidth;
            var buildings = [];
            var rooms = [];
            var calendar = null;
            var isGettingReservations = false;
            var firstRun = true;
            const dataTableTranslationStrings = {
                logs: {
                    error: 'Fehler',
                    success: 'Erfolg',
                    info: 'Information',
                },
                adminReservationStatus: {
                    0: "Abgelehnt",
                    1: "Angenommen"
                }
            };
            const apiURL = "http://terminator.api.jongmans.net/api";
            const moderatorDataTables = {};
            const adminDataTables = {};
            const dataTables = {};
            const dataTablesLocalisation = {
                sEmptyTable: "Keine Daten vorhanden",
                sInfo: "_START_ bis _END_ von _TOTAL_ Einträgen",
                sInfoEmpty: "0 bis 0 von 0 Einträgen",
                sInfoFiltered: "(gefiltert aus _MAX_ Einträgen)",
                sInfoPostFix: "",
                sInfoThousands: ".",
                sLengthMenu: "_MENU_ Einträge anzeigen",
                sLoadingRecords: "Wird geladen...",
                sProcessing: "Bitte warten...",
                sSearch: "Suchen:",
                sZeroRecords: "Keine Einträge vorhanden.",
                oPaginate: {
                    sFirst: "Erste",
                    sPrevious: "Zurück",
                    sNext: "Nächste",
                    sLast: "Letzte"
                },
                oAria: {
                    sSortAscending: ": aktivieren, um Spalte aufsteigend zu sortieren",
                    sSortDescending: ": aktivieren, um Spalte absteigend zu sortieren"
                }
            }
            const dataTablesOptions = {
                myReservations: {
                    order: [0, "asc"],
                    language: dataTablesLocalisation,
                    rowId: function(row) {
                        return "my-table-reservation-id-" + row["id"];
                    },
                    columns: [
                        {
                            name: "id",
                            data: "id",
                            width: "8%"
                        },
                        {
                            name: "room",
                            data: "room",
                            width: "8%"
                        },
                        {
                            name: "start",
                            data: "timeStart",
                            width: "8%",
                            render: function(data, type, row) {
                                if (type === "display" || type === "filter") {
                                    let date = new Date(Number.parseInt(data));
                                    return formatDate(date.getTime(), ["date", "time"]) + " Uhr";
                                }
                                return data;
                            }
                        },
                        {
                            name: "end",
                            data: "timeEnd",
                            width: "8%",
                            render: function(data, type, row) {
                                if (type === "display" || type === "filter") {
                                    let date = new Date(Number.parseInt(data));
                                    return formatDate(date.getTime(), ["date", "time"]) + " Uhr";
                                }
                                return data;
                            }
                        },
                        {
                            name: "description",
                            data: "description",
                        },
                        {
                            name: "status",
                            data: "status",
                            visible: false
                        }/*,
                        {
                            name: "options",
                            data: function(row, type, set, meta) {
                                return "<div class='d-flex flex-wrap' style='gap: 5px'><button type='button' class='btn btn-sm btn-success' style='width: 32px' onclick='showReservationEditModal(" + row["id"] + ")'><i class='fa-solid fa-check'></i></button><button type='button' class='btn btn-sm btn-danger' style='width: 32px' onclick='confirmReservationRescission(" + row["id"] + ")'><i class='fa-solid fa-xmark'></i></button></div>";
                            },
                            sorting: false,
                            width: "15%"
                        }*/
                    ],
                    ajax: {
                        url: apiURL + "/calendar/list",
                        type: "POST",
                        contentType: "application/json",
                        data: function(data, settings) {
                            //token: getCookie("authToken");
                            data["token"] = "C4NQDvFIk8L#^@z!UKUnxXFcCZ5qlt";
                            data["userid"] = getCookie("username");
                            return JSON.stringify(data);
                        },
                        dataSrc: function(response) {
                            return response;
                        },
                        error: function (response) {
                            $("#myReservationsReloadButton").removeAttr("disabled").find("[data-processing='true']").remove();
                            if (response.hasOwnProperty("responseJSON") && response["responseJSON"].hasOwnProperty("error")) {
                                if (response["responseJSON"]["error"] === "invalid_token") {
                                    $("#myReservations > .formContainer").first().before(Alert.create("danger", "Der Authentifizierungstoken ist ungültig. Bitte erneut anmelden."));
                                }
                            }
                            else {
                                $("#myReservations > .formContainer").first().before(Alert.create("danger", "Es konnten keine Daten geladen werden."));
                            }
                        }
                    },
                    drawCallback: function(settings) {
                        $("#myReservationTable").parent().addClass("table-container");
                    }
                }
            };
            const dataTablesModeratorOptions = {
                reservations: {
                    order: [0, "asc"],
                    language: dataTablesLocalisation,
                    rowId: function(row) {
                        return "moderation-table-reservation-id-" + row["id"];
                    },
                    columns: [
                        {
                            name: "id",
                            data: "id",
                            width: "8%"
                        },
                        {
                            name: "organisator",
                            data: "organisator",
                            visible: false,
                            width: "8%"
                        },
                        {
                            name: "roomid",
                            width: "8%",
                            data: function(row, type, set, meta) {
                                let index = rooms.findIndex(key => key["id"] === row["id"]);
                                return (index >= 0 ? rooms[index]["name"] : row["roomid"]);
                            }
                        },
                        {
                            name: "buildingid",
                            data: "buildingid",
                            width: "8%"
                        },
                        {
                            name: "startTime",
                            data: "startTime",
                            width: "8%",
                            render: function(data, type, row) {
                                if (type === "display" || type === "filter") {
                                    let date = new Date(Number.parseInt(data));
                                    return formatDate(date.getTime(), ["date", "time"]) + " Uhr";
                                }
                                return data;
                            }
                        },
                        {
                            name: "endTiime",
                            data: "endTime",
                            width: "8%",
                            render: function(data, type, row) {
                                if (type === "display" || type === "filter") {
                                    let date = new Date(Number.parseInt(data));
                                    return formatDate(date.getTime(), ["date", "time"]) + " Uhr";
                                }
                                return data;
                            }
                        },
                        {
                            name: "title",
                            data: "title",
                        },
                        {
                            name: "organisatorId",
                            data: "organisatorId",
                            visible: false
                        },
                        {
                            name: "declinedReason",
                            data: "declinedReason",
                            visible: false
                        },
                        {
                            name: "editorId",
                            data: "editorId",
                            visible: false
                        },
                        {
                            name: "options",
                            data: function(row, type, set, meta) {
                                return "<div class='d-flex flex-wrap' style='gap: 5px'><button type='button' class='btn btn-sm btn-success' style='width: 32px' onclick='confirmReservationApproval(" + row["id"] + ")'><i class='fa-solid fa-check'></i></button><button type='button' class='btn btn-sm btn-danger' style='width: 32px' onclick='confirmReservationRejection(" + row["id"] + ")'><i class='fa-solid fa-xmark'></i></button></div>";
                            },
                            sorting: false,
                            width: "8%"
                        }
                    ],
                    ajax: {
                        url: apiURL + "/calendar/list/pending",
                        type: "POST",
                        contentType: "application/json",
                        data: function(data, settings) {
                            //token: getCookie("authToken");
                            data["token"] = "C4NQDvFIk8L#^@z!UKUnxXFcCZ5qlt";
                            return JSON.stringify(data);
                        },
                        dataSrc: function(response) {
                            return response;
                        },
                        error: function (response) {
                            $("#reservationsModeratorReloadButton").removeAttr("disabled").find("[data-processing='true']").remove();
                            if (response.hasOwnProperty("responseJSON") && response["responseJSON"].hasOwnProperty("error")) {
                                if (response["responseJSON"]["error"] === "invalid_token") {
                                    $("#moderation > .formContainer").first().before(Alert.create("danger", "Der Authentifizierungstoken ist ungültig. Bitte erneut anmelden."));
                                }
                            }
                            else {
                                $("#moderation > .formContainer").first().before(Alert.create("danger", "Es konnten keine Daten geladen werden."));
                            }
                        }
                    },
                    drawCallback: function(settings) {
                        $("#moderatorReservationTable").parent().addClass("table-container");
                    }
                }
            };
            const dataTablesAdminOptions = {
                reservations: {
                    order: [0, "asc"],
                    language: dataTablesLocalisation,
                    rowId: function(row) {
                        return "administration-table-reservation-id-" + row["id"];
                    },
                    columns: [
                        {
                            name: "id",
                            data: "id",
                            width: "8%"
                        },
                        {
                            name: "organisator",
                            data: "organisator",
                            width: "8%",
                        },
                        {
                            name: "roomid",
                            width: "8%",
                            data: function(row, type, set, meta) {
                                let index = rooms.findIndex(key => key["id"] === row["id"]);
                                return (index >= 0 ? rooms[index]["name"] : row["roomid"]);
                            }
                        },
                        {
                            name: "buildingid",
                            data: "buildingid",
                            width: "8%",
                        },
                        {
                            name: "startTime",
                            data: "startTime",
                            width: "8%",
                            render: function(data, type, row) {
                                if (type === "display" || type === "filter") {
                                    let date = new Date(Number.parseInt(data));
                                    return formatDate(date.getTime(), ["date", "time"]);
                                }
                                return data;
                            }
                        },
                        {
                            name: "endTime",
                            data: "endTime",
                            width: "8%",
                            render: function(data, type, row) {
                                if (type === "display" || type === "filter") {
                                    let date = new Date(Number.parseInt(data));
                                    return formatDate(date.getTime(), ["date", "time"]);
                                }
                                return data;
                            }
                        },
                        {
                            name: "title",
                            data: "title"
                        },
                        {
                            name: "accepted",
                            width: "8%",
                            data: function(row, type, set, meta) {
                                return (dataTableTranslationStrings["adminReservationStatus"].hasOwnProperty(row["accepted"]) ? dataTableTranslationStrings["adminReservationStatus"][row["accepted"]] : row["accepted"]);
                            }
                        },
                        {
                            name: "organisatorId",
                            data: "organisatorId",
                            visible: false
                        },
                        {
                            name: "declinedReason",
                            data: "declinedReason",
                            visible: false
                        },
                        {
                            name: "editorId",
                            data: "editorId",
                            visible: false
                        },
                        {
                            name: "options",
                            data: function(row, type, set, meta) {
                                return "<div class='d-flex flex-wrap' style='gap: 5px'><button type='button' class='btn btn-sm btn-primary' style='width: 32px' onclick='showAdminReservationEditingModal(" + row["id"] + ")'><i class='fa-solid fa-pen'></i></button><button type='button' class='btn btn-sm btn-danger' style='width: 32px' onclick='confirmAdminReservationDeletion(" + row["id"] + ")'><i class='fa-solid fa-times'></i></button></div>";
                            },
                            sorting: false,
                            width: "8%"
                        }
                    ],
                    ajax: {
                        url: apiURL + "/calendar/list/all",
                        type: "POST",
                        contentType: "application/json",
                        data: function(data, settings) {
                            //data["token"] = getCookie("authToken");
                            data["token"] = "C4NQDvFIk8L#^@z!UKUnxXFcCZ5qlt";
                            return JSON.stringify(data);
                        },
                        dataSrc: function(response) {
                            return response;
                        },
                        error: function (response) {
                            $("#reservationsAdminReloadButton").removeAttr("disabled").find("[data-processing='true']").remove();
                            if (response.hasOwnProperty("responseJSON") && response.hasOwnProperty("responseJSON")) {
                                if (response["responseJSON"]["error"] === "invalid_token") {
                                    $("#collapse-reservations > .formContainer").first().before(Alert.create("danger", "Der Authentifizierungstoken ist ungültig. Bitte erneut anmelden."));
                                }
                            }
                            else {
                                $("#collapse-reservations > .formContainer").first().before(Alert.create("danger", "Es konnten keine Daten geladen werden."));
                            }
                        }
                    },
                    drawCallback: function(settings) {
                        $("#reservationsAdminTable").parent().addClass("table-container");
                    }
                },
                buildings: {
                    order: [0, "asc"],
                    language: dataTablesLocalisation,
                    rowId: function(row) {
                        return "administration-table-building-id-" + row["id"];
                    },
                    columns: [
                        {
                            name: "id",
                            data: "id",
                            width: "8%"
                        },
                        {
                            name: "name",
                            data: "name",
                            width: "8%",
                        },
                        {
                            name: "description",
                            data: "description",
                        },
                        {
                            name: "options",
                            data: function(row, type, set, meta) {
                                let buttons = "<div class='d-flex flex-wrap' style='gap: 5px'><button type='button' class='btn btn-sm btn-primary' style='width: 32px' onclick='showBuildingEditingModal(" + row["id"] + ")' title='Gebäude bearbeiten'><i class='fa-solid fa-pen'></i></button>";
                                buttons += "<button type='button' class='btn btn-sm btn-danger' style='width: 32px' onclick='confirmBuildingDeletion(" + row["id"] + ")' title='Gebäude entfernen'><i class='fa-solid fa-times'></i></button>";
                                return buttons;
                            },
                            sorting: false,
                            width: "8%"
                        }
                    ],
                    ajax: {
                        url: apiURL + "/building/list",
                        type: "GET",
                        contentType: "application/json",
                        data: function(data, settings) {
                            //data["token"] = getCookie("authToken");
                            data["token"] = "C4NQDvFIk8L#^@z!UKUnxXFcCZ5qlt";
                            return JSON.stringify(data);
                        },
                        dataSrc: function(response) {
                            Object.assign(buildings, response);
                            return response;
                        },
                        error: function (response) {
                            $("#buildingsAdminReloadButton").removeAttr("disabled").find("[data-processing='true']").remove();
                            if (response.hasOwnProperty("responseJSON") && response["responseJSON"].hasOwnProperty("error")) {
                                if (response["responseJSON"]["error"] === "invalid_token") {
                                    $("#collapse-buildings > .formContainer").first().before(Alert.create("danger", "Der Authentifizierungstoken ist ungültig. Bitte erneut anmelden."));
                                }
                            }
                            else {
                                $("#collapse-buildings > .formContainer").first().before(Alert.create("danger", "Es konnten keine Daten geladen werden."));
                            }
                        }
                    },
                    drawCallback: function(settings) {
                        $("#buildingsAdminTable").parent().addClass("table-container");
                    }
                },
                rooms: {
                    order: [0, "asc"],
                    language: dataTablesLocalisation,
                    rowId: function(row) {
                        return "administration-table-reservation-id-" + row["id"];
                    },
                    columns: [
                        {
                            name: "id",
                            data: "id",
                            width: "8%"
                        },
                        {
                            name: "building",
                            data: "buildingid",
                            visible: false
                        },
                        {
                            name: "name",
                            data: "name",
                            width: "8%"
                        },
                        {
                            name: "description",
                            data: "description",
                        },
                        {
                            name: "options",
                            data: function(row, type, set, meta) {
                                return "<div class='d-flex flex-wrap' style='gap: 5px'><button type='button' class='btn btn-sm btn-primary' style='width: 32px' onclick='showRoomEditingModal(" + row["id"] + ")'><i class='fa-solid fa-pen'></i></button><button type='button' class='btn btn-sm btn-danger' style='width: 32px' onclick='confirmRoomDeletion(" + row["id"] + ")'><i class='fa-solid fa-times'></i></button></div>";
                            },
                            sorting: false,
                            width: "8%"
                        }
                    ],
                    ajax: {
                        url: apiURL + "/room/list",
                        type: "POST",
                        data: function(data, settings) {
                            //data["token"] = getCookie("authToken");
                            data["token"] = "C4NQDvFIk8L#^@z!UKUnxXFcCZ5qlt";
                            return JSON.stringify(data);
                        },
                        dataSrc: function(response) {
                            Object.assign(rooms, response);
                            return response;
                        },
                        error: function (response) {
                            $("#roomsAdminReloadButton").removeAttr("disabled").find("[data-processing='true']").remove();
                            if (response.hasOwnProperty("responseJSON") && response["responseJSON"].hasOwnProperty("error")) {
                                if (response["responseJSON"]["error"] === "invalid_token") {
                                    $("#collapse-rooms > .formContainer").first().before(Alert.create("danger", "Der Authentifizierungstoken ist ungültig. Bitte erneut anmelden."));
                                }
                            }
                            else {
                                $("#collapse-rooms > .formContainer").first().before(Alert.create("danger", "Es konnten keine Daten geladen werden."));
                            }
                        }
                    },
                    drawCallback: function(settings) {
                        $("#roomsAdminTable").parent().addClass("table-container");
                    }
                },
                logs: {
                    language: dataTablesLocalisation,
                    serverSide: true,
                    columns: [
                        {
                            name: 'id',
                            data: 'id',
                            visible: false,
                        },
                        {
                            name: 'timestamp',
                            data: 'timestamp',
                            width: '15%',
                            render: function (data, type, row) {
                                if (type === 'display' || type === 'filter') {
                                    let date = new Date(Number.parseInt(data));
                                    return ('00' + date.getDate().toString()).substr(-2, 2) + '.' + ('00' + (date.getMonth() + 1).toString()).substr(-2, 2) + '.' + date.getFullYear() + ', ' + ('00' + date.getHours().toString()).substr(-2, 2) + ':' + ('00' + date.getMinutes().toString()).substr(-2, 2) + ':' + ('00' + date.getSeconds().toString()).substr(-2, 2);
                                }
                                return data;
                            },
                        },
                        {
                            name: 'type',
                            data: function(row, type, set, meta) {
                                return dataTableTranslationStrings['logs'][row['type']];
                            },
                            width: '8%',
                        },
                        {
                            name: 'message',
                            data: 'message',
                            width: '50%',
                            orderable: false,
                        }
                    ],
                    order: [1, 'asc'],
                    ajax: {
                        url: apiURL + '/device/logs',
                        type: 'POST',
                        contentType: 'application/json',
                        data: function (data, settings) {
                            data['token'] = getCookie('authToken');
                            data["token"] = "C4NQDvFIk8L#^@z!UKUnxXFcCZ5qlt";
                            console.log(data.order);
                            return JSON.stringify(data);
                        },
                        dataSrc: function (response) {
                            return response['data'];
                        },
                        error: function (response) {
                            $("#logsAdminReloadButton").removeAttr("disabled").find("[data-processing='true']").remove();
                            if (response.hasOwnProperty("responseJSON") && response["responseJSON"].hasOwnProperty("error")) {
                                if (response["responseJSON"]["error"] === "invalid_token") {
                                    $("collapse-logs > .formContainer").first().before(Alert.create("danger", "Der Authentifizierungstoken ist ungültig. Bitte erneut anmelden."));
                                }
                            }
                            else {
                                $("#collapse-logs > .formContainer").first().before(Alert.create("danger", "Es konnten keine Daten geladen werden."));
                            }
                        }
                    },
                    drawCallback: function (settings) {
                        $('#logsAdminTable').parent().addClass('table-container');
                    },
                },
            }
            function logout() {
                //cookies löschen
            }
            function getBuildings() {
                $("#buildingSelection").empty();
                $.get({
                    url: apiURL + "/building/list",
                    contentType: "application/json",
                }).done(function(response) {;
                    Object.assign(buildings, response);
                    if (response.length === 0 && $("#calendar #noBuildingsFoundWarning").length === 0) {
                        $("#calendarLocationForm").before(Alert.create("warning", "Es wurden keine Gebäude in der Datenbank gefunden, für die Reservierungen angezeigt oder angelegt werden können. Wenden Sie sich an einen für diese Seite zuständigen Administrator, damit dieses Problem behoben werden kann.", {id: "noBuildingsFoundWarning", closeable: false}));
                    }
                    else {
                        $("#noBuildingsFoundWarning").remove();
                        for (building of response) {
                            $("#buildingSelection").append("<option value='" + building["id"] + "'>" + building["name"] + "</option>");
                        }
                        $("#buildingSelection").change();
                    }
                }).fail(function(response) {
                    $("#calendar").prepend(Alert.create("danger", response["status"] + ": " + response["statusText"]));
                }).always(function() {
                });
            }
            function getRooms() {
                $("#roomSelection").empty();
                $.post({
                    url: apiURL + "/room/list",
                    contentType: "application/json",
                }).done(function(response) {;
                    Object.assign(rooms, response);
                    if (response.length === 0 && $("#calendar #noRoomsFoundWarning").length === 0) {
                        $("#calendarLocationForm").before(Alert.create("warning", "Es wurden keine Räume in der Datenbank gefunden, für die Reservierungen angezeigt oder angelegt werden können. Wenden Sie sich an einen für diese Seite zuständigen Administrator, damit dieses Problem behoben werden kann.", {id: "noRoomsFoundWarning", closeable: false}));
                    }
                    else {
                        $("#noRoomsFoundWarning").remove();
                    }
                    for (room of response) {
                        $("#roomSelection").append("<option value='" + room["id"] + "'>" + room["name"] + "</option>");
                    }
                }).fail(function(response) {
                    $("#calendar").prepend(Alert.create("danger", response["status"] + ": " + response["statusText"]));
                }).always(function() {
                });
            }
            function reloadDataTableData(element, table) {
                if (DataTable.isDataTable(table)) {
                    if ($(element).find("[data-processing='true']").length === 0) {
                        $(element).attr("disabled", "disabled").prepend("<span class='spinner-border me-1 text-white kreiselchen align-text-bottom' data-processing='true'></span>");
                    }
                    $(table).DataTable().ajax.reload();
                }
            }
            function updateSystemInfos() {
                if ($('#mainModal').hasClass('show') && $('#mainModal').attr('data-name') === 'systemInfos' && !isLoadingSystemInfos) {
                    isLoadingSystemInfos = true;
                    $.get({
                        url: apiURL + '/device/informations',
                        crossDomain: true,
                        timeout: 10000,
                    })
                    .done(function (response) {
                        let statsText = '';
                        statsText += "<tr><td class='align-top'>Betriebssystem</td><td>" + response['type'] + ' ' + response['release'] + '</td></tr>';
                        statsText += "<tr><td class='align-top'>Architektur</td><td>" + response['arch'] + '</td></tr>';
                        statsText += "<tr><td class='align-top'>Hostname</td><td>" + response['hostname'] + '</td></tr>';
                        statsText += "<tr><td class='align-top'>CPU</td><td>" + response['cpus'][0]['model'];

                        for (let [index, cpu] of response['cpus'].entries()) {
                            statsText += '<div>CPU #' + index + ":<div class='ps-3'>Takt: " + cpu['speed'] + 'MHz</div></div>';
                        }

                        let totalMemory = (response['totalmem'] / 1024 / 1024 / 1024).toFixed(2);
                        let totalMemoryFree = (response['freememory'] / 1024 / 1024 / 1024).toFixed(2);

                        statsText += "<tr><td class='align-top'>RAM (Insgesamt)</td><td>" + totalMemory + ' GB</td></tr>';
                        statsText += "<tr><td class='align-top'>RAM (Verwendet)</td><td>" + (totalMemory - totalMemoryFree).toFixed(2) + ' GB (~' + (((totalMemory - totalMemoryFree) / totalMemory) * 100).toFixed(2) + ' %) </td></tr>';
                        statsText += "<tr><td class='align-top'>Durchschnittslast (1 Minute)</td><td>" + response['loadavg'][0] + '</td></tr>';
                        statsText += "<tr><td class='align-top'>Durchschnittslast (5 Minuten)</td><td>" + response['loadavg'][1] + '</td></tr>';
                        statsText += "<tr><td class='align-top'>Durchschnittslast (15 Minuten)</td><td>" + response['loadavg'][2] + '</td></tr>';
                        statsText += "<tr><td class='align-top'>Laufzeit</td><td>" + response['uptime'].duration() + '</td></tr>';
                        statsText += "<tr><td class='align-top'>Backend Version</td><td>" + response['version'] + '</td></tr>';
                        $('#systemInfosTable').html(statsText);
                    })
                    .fail(function (response) {
                        console.log(response);
                    })
                    .always(function () {
                        isLoadingSystemInfos = false;
                    });
                }
            }
            function getCookie(cname) {
                let name = cname + "=";
                let ca = document.cookie.split(";");
                for (let i = 0; i < ca.length; i++) {
                    let c = ca[i];
                    while (c.charAt(0) == " ") {
                        c = c.substring(1);
                    }
                    if (c.indexOf(name) == 0) {
                        return decodeURIComponent(c.substring(name.length, c.length));
                    }
                }
                return "";
            }
            function readjustTables() {
                let collapses = ["#collapse-rooms", "#collapse-roles", "#collapse-reservations", "#collapse-buildings", "#collapse-logs"];
                let element = null;
                let tableName = null;
                for (collapse of collapses) {
                    element = $("a[href='" + collapse + "']");
                    tableName = $(element).attr("data-admin-table");
                    if (DataTable.isDataTable(tableName) && $(element).attr("aria-expanded") === "true") {
                        adminDataTables[tableName].columns.adjust().draw();
                    }
                }
            }
            /*
            function hidePopOver(element) {
                bootstrap.Popover.getInstance($(element).parents(".popover")[0]).hide();
            }
            */
            function confirmRoomDeletion(lol) {
                if (DataTable.isDataTable("#roomsAdminTable")) {
                    let rooms = adminDataTables["rooms"].data().toArray();
                    let roomId = Number.parseInt(lol);
                    let index = rooms.findIndex(key => key["id"] === roomId);
                    if (index >= 0) {
                        let indexBuilding = buildings.findIndex(key => key["id"] === rooms[index]["buildingid"]);
                        let prompt = new Promise(function(resolve) {
                            confirmation({
                                title: "Raum löschen bestätigen",
                                content: "Soll der Raum &quot;" + rooms[index]["name"] + "&quot; (Gebäude: &quot;" + buildings[indexBuilding]["name"] + "&quot;) wirklich gelöscht werden?"
                            }, resolve);
                        });
                        prompt.then(function(value) {
                            disableMainModal("#confirmationButton");
                            $.post({
                                url: apiURL + "/building/delete",
                                data: JSON.stringify({
                                    //token: getCookie("authToken"),
                                    token: "C4NQDvFIk8L#^@z!UKUnxXFcCZ5qlt",
                                    id: roomId,
                                }),
                                processData: false,
                                contentType: "application/json",
                                crossDomain: true,
                                timeout: 10000
                            }).done(function(response) {
                                bootstrap.Modal.getInstance($("#mainModal")[0]).hide();
                                $("#roomsAdminTable_wrapper").before(Alert.create("success", "Der Raum &quot;" + rooms[index]["name"] + "&quot; (ID: " + lol + ") wurde gelöscht."));
                                $("#roomsAdminTable").DataTable().ajax.reload();
                            }).fail(function(response) {
                                $("#mainModal .modal-body").prepend(Alert.create("danger", response["status"] + ": " + response["statusText"]));
                            }).always(function() {
                                enableMainModal("#confirmationButton");
                            });
                        });
                    }
                }
            }
            function confirmRoleDeletion(lol) {
                if (DataTable.isDataTable("#rolesAdminTable")) {
                    let roles = adminDataTables["roles"].data().toArray();
                    let index = roles.findIndex(key => key["id"] === Number.parseInt(lol));
                    if (index >= 0) {
                        let prompt = new Promise(function(resolve) {
                            confirmation({
                                title: "Benutzerrolle &quot;" + roles["name"] + "&quot; entfernen",
                                content: "Soll die Benutzerrolle &quot;"  + roles["name"] + "&quot; wirklich entfernt werden?"
                            }, resolve);
                        });
                        prompt.then(function(value) {
                            bootstrap.Modal.getInstance($("#mainModal")[0]).hide();
                        });
                    }
                }
            }
            function confirmation(options = {}, resolve) {
                let data = {
                    name: "confirmation",
                    title: {
                        text: (options.hasOwnProperty("title") ? options["title"] : "Bestätigung")
                    },
                    content: {
                        text: (options.hasOwnProperty("content") ? options["content"] : "Soll diese Aktion wirklich ausgeführt werden?")
                    },
                    footer: {
                        buttons: {
                            default: {
                                text: "Nein",
                                class: "btn-primary"
                            },
                            custom: [
                                {
                                    text: "Ja",
                                    class: "btn-danger",
                                    attributes: {
                                        id: "confirmationButton"
                                    },
                                    actions: {
                                        click: {
                                            function: function() {
                                                resolve(true);
                                            }
                                        }
                                    }
                                }
                            ]
                        }
                    }
                };
                Modal.create(data);
            }
            class Alert {
                static icons = {
                    danger: "fas fa-exclamation-circle",
                    primary: "fas fa-info-circle",
                    warning: "fas fa-exclamation-triangle",
                    success: "fas fa-check-circle"
                };
                static types = ["primary", "success", "danger", "warning"];
                static alerts = [];
                constructor(type, message, options = {}) {
                    // options = {class: "", id = "", closeable = true}
                    type = (Alert.types.includes(type.toLowerCase()) ? type.toLowerCase() : "primary");
                    let text = "";
                    if (Array.isArray(message)) {
                        text = "<ul class='m-0 p-0' style='list-style-position: inside'>";
                        for (let msg of message) {
                            text += "<li>" + msg + "</li>";
                        }
                        text += "</ul>";
                    }
                    else {
                        text = message;
                    }
                    let id;
                    if (!options.hasOwnProperty("id") || ["undefined", undefined, null, ""].includes(options["id"])) {
                        id = 'alert_' + type + '_' + (Date.now() + Number.parseInt(Math.random().toString().split(".")[1]));
                        while (Alert.alerts.includes(id)) {
                            id = 'alert_' + type + '_' + (Date.now() + Number.parseInt(Math.random().toString().split(".")[1]));
                        }
                    }
                    else {
                        if ($("#" + options["id"]).length >= 1) {
                            alert("Die ID \"" + options["id"] + "\" ist bereits einem Element zugeordnet.");
                            return;
                        }
                        id = options["id"];
                    }
                    let element;
                    let closeable = ((options.hasOwnProperty("closeable") && options["closeable"]) || !options.hasOwnProperty("closeable") ? true : false);
                    let classes = ((!options.hasOwnProperty("class") || ["undefined", undefined, null, ""].includes(options["class"])) ? true : false);
                    element = '<div class="alert alert-' + type + ' alertBoxContainer' + (closeable ? " alert-dismissible" : "") + (classes ? " " + options["class"] : "") + '" id="' + id + '">';
                    element += '<div class="alertBoxIcon ' + type + '">';
                    element += '<i class="' + Alert.icons[type] + '"></i>';
                    element += '</div><div class="alertBoxText d-flex align-items-center">';
                    if (closeable) {
                        element += '<button type="button" class="btn-close" data-bs-dismiss="alert"></button>';
                    }
                    element += text + '</div></div>';
                    Alert.alerts.push(id);
                    this.id = id;
                    this.type = type;
                    this.message = text;
                    this.options = options;
                    this.element = $(element).one("close.bs.alert", function() {
                        Alert.destroy($(this).attr("id"));
                    });
                }
                destroy() {
                    Alert.alerts.splice(Alert.alerts.indexOf(this.id), 1);
                    $("#" + this.id).remove();
                }
                static create(type, message, options = {}) {
                    type = (Alert.types.includes(type.toLowerCase()) ? type.toLowerCase() : "primary");
                    let text = "";
                    if (Array.isArray(message)) {
                        text = "<ul class='m-0 p-0' style='list-style-position: inside'>";
                        for (let msg of message) {
                            text += "<li>" + msg + "</li>";
                        }
                        text += "</ul>";
                    }
                    else {
                        text = message;
                    }
                    let id;
                    if (!options.hasOwnProperty("id") || ["undefined", undefined, null, ""].includes(options["id"])) {
                        id = 'alert_' + type + '_' + (Date.now() + Number.parseInt(Math.random().toString().split(".")[1]));
                        while (Alert.alerts.includes(id)) {
                            id = 'alert_' + type + '_' + (Date.now() + Number.parseInt(Math.random().toString().split(".")[1]));
                        }
                    }
                    else {
                        if ($("#" + options["id"]).length >= 1) {
                            alert("Die ID \"" + options["id"] + "\" ist bereits einem Element zugeordnet.");
                            return;
                        }
                        id = options["id"];
                    }
                    let element;
                    let closeable = ((options.hasOwnProperty("closeable") && options["closeable"]) || !options.hasOwnProperty("closeable") ? true : false);
                    let classes = (options.hasOwnProperty("class") && !["undefined", undefined, null, ""].includes(options["class"]) ? true : false);
                    element = '<div class="alert alert-' + type + ' alertBoxContainer' + (closeable ? " alert-dismissible" : "") + (classes ? " " + options["class"] : "") + '" id="' + id + '">';
                    element += '<div class="alertBoxIcon ' + type + '">';
                    element += '<i class="' + Alert.icons[type] + '"></i>';
                    element += '</div><div class="alertBoxText d-flex align-items-center">';
                    if (closeable) {
                        element += '<button type="button" class="btn-close" data-bs-dismiss="alert"></button>';
                    }
                    element += text + '</div></div>';
                    Alert.alerts.push(id);
                    return $(element).one("close.bs.alert", {id: id}, function(event) {
                        Alert.destroy(event["data"]["id"]);
                    });
                }
                static destroy(id) {
                    Alert.alerts.splice(Alert.alerts.indexOf(id), 1);
                    $("#" + id).remove();
                }
            }
            // Wird verwendet, um Funktionen innerhalb von Objekten auszuführen
            function achso(callback, args = null) {
                callback.apply(this, args);
            }
            class Modal {
                /*
                data: {
                     size?: sm|default|lg|xl|fullscreen,
                    static?: bool,
                    name: string,
                    events?: {
                        hide: {
                                function: function() { },
                                args?: []
                            }
                        }
                    },
                    title: {
                        text: string
                    },
                    content: {
                        text: string
                        options?: {
                            scroll?: bool,
                            align?: left|center|right
                        }
                    },
                    footer?: {
                        buttons?: {
                            default?: {
                                text: string,
                                class?: string,
                                display?: bool,
                                attributes?: {
                                    attribute: value
                                }
                            }
                            // Eigene
                            custom?: [
                                {
                                    text: string,
                                    class?: string,
                                    attributes?: {},
                                    actions: {
                                        click: {
                                                function: (string|function() {}),
                                                args?: []
                                            }
                                        }
                                    }
                                }]
                            }
                        }
                    }
                }
                */
                static create(data = {}) {
                    if ($("#mainModal").hasClass("show")) {
                        $("#mainModal").hide();
                    }
                    $("#mainModal > div:first-of-type").removeClass("modal-sm modal-lg modal-xl modal-fullscreen modal-dialog-scrollable modal-dialog-centered");
                    $("#mainModal").removeAttr("data-bs-backdrop data-bs-keyboard");
                    $("#mainModal .modal-header > h4").empty();
                    $("#mainModal .modal-body").empty();
                    $("#mainModal .modal-footer").empty();
                    if (data.hasOwnProperty("name")) {
                        $("#mainModal").attr("data-name", data["name"]);
                        if (data.hasOwnProperty("size") && ["sm", "lg", "xl", "fullscreen"].includes(data["size"])) {
                            $("#mainModal > div:first-of-type").addClass("modal-" + data["size"]);
                        }
                        if (data.hasOwnProperty("static") && data["static"]) {
                            $("#mainModal").attr({"data-bs-backdrop":"static", "data-bs-keyboard":"false"});
                        }
                        if (data.hasOwnProperty("title")) {
                            if (data["title"].hasOwnProperty("text") && !["undefined", "", undefined, null].includes(data["title"]["text"])) {
                                $("#mainModal .modal-header > h4").html(data["title"]["text"]);
                            }
                        }
                        if (data.hasOwnProperty("content")) {
                            if (data["content"].hasOwnProperty("options")) {
                                if (data["content"]["options"].hasOwnProperty("scroll") && data["content"]["options"]["scroll"]) {
                                    $("#mainModal > div:first-of-type").addClass("modal-dialog-scrollable");
                                }
                            }
                            if (data["content"].hasOwnProperty("text") && !["undefined", "", undefined, null].includes(data["content"]["text"])) {
                                $("#mainModal .modal-body").html(data["content"]["text"]);
                            }
                        }
                        if (data.hasOwnProperty("footer")) {
                            if (data["footer"].hasOwnProperty("buttons")) {
                                if (data["footer"]["buttons"].hasOwnProperty("default")) {
                                    let defaultButtonText = "";
                                    let defaultButtonClass = "";
                                    let defaultButton = $("<button type='button' data-bs-dismiss='modal' class='btn'>");
                                    if ((data["footer"]["buttons"].hasOwnProperty("display") && data["footer"]["buttons"]["display"]) || !data["footer"]["buttons"].hasOwnProperty("display")) {
                                        if (data["footer"]["buttons"]["default"].hasOwnProperty("text") && !["undefined", "", undefined, null].includes(data["footer"]["buttons"]["default"]["text"])) {
                                            defaultButtonText = data["footer"]["buttons"]["default"]["text"];
                                        }
                                        else {
                                            defaultButtonText = "Schließen";
                                        }
                                    }
                                    if (data["footer"]["buttons"]["default"].hasOwnProperty("class") && !["undefined", "", undefined, null].includes(data["footer"]["buttons"]["default"]["class"])) {
                                        defaultButtonClass = data["footer"]["buttons"]["default"]["class"];
                                    }
                                    else {
                                        defaultButtonClass = "btn-secondary";
                                    }
                                    $(defaultButton).addClass(defaultButtonClass).html(defaultButtonText);
                                    if (data["footer"]["buttons"]["default"].hasOwnProperty("attributes")) {
                                        let attributes = Object.getOwnPropertyNames(data["footer"]["buttons"]["default"]["attributes"]);
                                        for (let attribute of attributes) {
                                            $(defaultButton).attr(attribute, data["footer"]["buttons"]["default"]["attributes"][attribute]);
                                        }
                                    }
                                    $("#mainModal .modal-footer").append(defaultButton);
                                }
                                else {
                                    $("#mainModal .modal-footer").append("<button type='button' class='btn btn-secondary' data-bs-dismiss='modal'>Schließen</button>");
                                }
                                if (data["footer"]["buttons"].hasOwnProperty("custom")) {
                                    let customButtons = data["footer"]["buttons"]["custom"];
                                    for (let customButton of customButtons) {
                                        if (customButton.hasOwnProperty("text") && !["undefined", "", undefined, null].includes(customButton["text"]) /*&& customButton.hasOwnProperty("actions") && !["undefined", undefined, null].includes(customButton["actions"])*/) {
                                            let currentButton = $("<button type='button' class='btn'>" + customButton["text"] + "</button>");
                                            if (customButton.hasOwnProperty("class") && !["undefined", "", undefined, null].includes(customButton["class"])) {
                                                $(currentButton).addClass(customButton["class"]);
                                            }
                                            else {
                                                $(currentButton).addClass("btn-primary");
                                            }
                                            let actions = Object.getOwnPropertyNames(customButton["actions"]);
                                            for (let action of actions) {
                                                if (customButton["actions"][action].hasOwnProperty("args") && typeof(customButton["actions"][action]["function"]) === "object") {
                                                    $(currentButton).on(action, function() {
                                                        achso(customButton["actions"][action]["function"], customButton["actions"][action]["args"]);
                                                    });
                                                }
                                                else if (typeof(customButton["actions"][action]["function"]) === "function") {
                                                    $(currentButton).on(action, function() {
                                                        achso(customButton["actions"][action]["function"]);
                                                    });
                                                }
                                            }
                                            if (customButton.hasOwnProperty("attributes")) {
                                                let attributes = Object.getOwnPropertyNames(customButton["attributes"]);
                                                for (let attribute of attributes) {
                                                    $(currentButton).attr(attribute, customButton["attributes"][attribute]);
                                                }
                                            }
                                            $("#mainModal .modal-footer").prepend(currentButton);
                                        }
                                    }
                                }
                            }
                            else {
                                $("#mainModal .modal-footer").append("<button type='button' class='btn btn-secondary' data-bs-dismiss='modal'>Schließen</button>");
                            }
                        }
                        else {
                            $("#mainModal .modal-footer").append("<button type='button' class='btn btn-secondary' data-bs-dismiss='modal'>Schließen</button>");
                        }
                        if (data.hasOwnProperty("events")) {
                            let eventNames = {hide: "hide.bs.modal", hidden: "hidden.bs.modal", show: "show.bs.modal", shown: "shown.bs.modal", hidePrevented: "hidePrevented.bs.modal"};
                            let events_ = Object.getOwnPropertyNames(data["events"]);
                            for (let event_ of events_) {
                                if (eventNames.hasOwnProperty(event_)) {
                                    if (data["events"][event_].hasOwnProperty("args") && typeof(data["events"][event_]["function"]) === "object") {
                                        $("#mainModal").one(eventNames[event_], function() {
                                            achso(data["events"][event_]["function"], data["events"][event_]["args"]);
                                        });
                                    }
                                    else if (typeof(data["events"][event_]["function"]) === "function") {
                                        $("#mainModal").one(eventNames[event_], function() {
                                            achso(data["events"][event_]["function"]);
                                        });
                                    }
                                }
                            }
                        }
                        new bootstrap.Modal($("#mainModal")).show();
                    }
                    else {
                        alert("Fehler: Es muss ein gültiger Name für den Dialog angegeben werden.");
                    }
                }
            }
            function checkHours(element) {
                let value = Number.parseInt($(element).val());
                if (Number.isSafeInteger(value)) {
                    if (value <= -1 || value >= 24) {
                        $(element).val("00");
                    }
                }
                else {
                    $(element).val("00");
                }
            }
            function checkMinutes(element) {
                let value = Number.parseInt($(element).val());
                if (Number.isSafeInteger(value)) {
                    if (value <= -1 || value >= 60) {
                        $(element).val("00");
                    }
                }
                else {
                    $(element).val("00");
                }
            }
            // lol = id aus "rowGroup"
            function showRoomCreationModal(lol = null) {
                let content = "<form enctype='text/plain' id='roomCreationForm' method='post' action='/' class='w-100'><input type='submit' class='d-none' id='newRoomSubmit'>";
                content += "<div><label class='col-form-label me-2' for='newRoomBuildingSelect'>Gebäude:</label>";
                content += "<select class='form-select' id='newRoomBuildingSelect' required='required'></select></div>";
                content += "<div class='mt-3'><label class='col-form-label me-2' for='newRoomRoomNameInput'>Name:</label>";
                content += "<input type='text' class='form-control' id='newRoomNameInput' required='required'></div>";
                content += "<div class='mt-3'><label class='col-form-label me-2' for='newRoomDescriptionInput'>Beschreibung (optional):</label>";
                content += "<input type='text' class='form-control' id='newRoomDescriptionInput'></div></form>";
                let data = {
                    name: "roomCreation",
                    static: true,
                    events: {
                        show: {
                            function: function() {
                                loadBuildings("#newRoomBuildingSelect");
                                if (lol !== null) {
                                    $("#newRoomBuildingSelect").val(lol);
                                }
                                $("#roomCreationForm").submit(function() {
                                    saveNewRoom();
                                    return false;
                                });
                            }
                        },
                        hide: {
                            function: function() {
                                $("#roomCreationForm").off("submit");
                            }
                        }
                    },
                    title: {
                        text: "Neuen Raum erstellen"
                    },
                    content: {
                        text: content
                    },
                    footer: {
                        buttons: {
                            default: {
                                text: "Abbrechen",
                                class: "btn-danger"
                            },
                            custom: [
                                {
                                    text: "Speichern",
                                    class: "btn-primary",
                                    attributes: {
                                        id: "saveNewRoomButton"
                                    },
                                    actions: {
                                        click: {
                                            function: function() {
                                                $("#newRoomSubmit").click();
                                            }
                                        }
                                    }
                                }
                            ]
                        }
                    }
                };
                Modal.create(data);
            }
            function disableMainModal(mainButton) {
                if ($("#body-overlay").length === 0) {
                    $("body").prepend("<div id='body-overlay' style='background-color: transparent'></div>");
                }
                if ($(mainButton).find("[data-processing='true']").length === 0) {
                    $(mainButton).prepend("<span class='spinner-border me-1 text-white kreiselchen align-text-bottom' data-processing='true'></span>");
                }
                $("#mainModal .modal-footer > button").attr("disabled", "disabled");
                $("#mainModal .modal-header > [data-bs-dismiss='modal']").attr("disabled", "disabled");
                $("#mainModal .modal-body > .alert").remove();
            }
            function enableMainModal(mainButton) {
                $(mainButton).find("[data-processing='true']").remove();
                $(mainButton).removeAttr("disabled");
                $("#body-overlay").remove();
                $("#mainModal .modal-footer > [data-bs-dismiss='modal']").removeAttr("disabled");
                $("#mainModal .modal-header > [data-bs-dismiss='modal']").removeAttr("disabled");
            }
            function showRoomEditingModal(lol) {
                if (DataTable.isDataTable("#roomsAdminTable")) {
                    let rooms = adminDataTables["rooms"].data().toArray();
                    let index = rooms.findIndex(key => key["id"] === lol);
                    if (index >= 0) {
                        let content = "<form enctype='text/plain' id='roomEditingForm' method='post' action='/' class='w-100'><input type='submit' class='d-none' id='editRoomSubmit'><label for='editRoomNameInput' class='form-label'>Name:</label>";
                        content += "<input type='text' class='form-control' id='editRoomNameInput' placeholder='Name eingeben' required='required' value='" + rooms[index]["name"] + "'></div>";
                        content += "<div class='mt-3'><label for='editRoomDescriptionInput' class='form-label'>Beschreibung:</label>";
                        content += "<input type='text' class='form-control' id='editRoomDescriptionInput' placeholder='Beschreibung eingeben' required='required' value='" + rooms[index]["description"] + "'></div></form>";
                        let data = {
                            name: "roomEditing",
                            static: true,
                            events: {
                                shown: {
                                    function: function() {
                                        $("#roomEditingForm").submit(function() {
                                            saveEditedRoom(lol);
                                            return false;
                                        });
                                    }
                                },
                                hide: {
                                    function: function() {
                                        $("#roomEditingForm").off("submit");
                                    }
                                }
                            },
                            title: {
                                text: "Raum &quot;" + rooms[index]["name"] + "&quot; bearbeiten"
                            },
                            content: {
                                text: content
                            },
                            footer: {
                                buttons: {
                                    default: {
                                        text: "Abbrechen",
                                        class: "btn-danger"
                                    },
                                    custom: [
                                        {
                                            text: "Speichern",
                                            class: "btn-primary",
                                            attributes: {
                                                id: "saveEditedRoomButton"
                                            },
                                            actions: {
                                                click: {
                                                    function: function() {
                                                        $("#editRoomSubmit").click();
                                                    }
                                                }
                                            }
                                        }
                                    ]
                                }
                            }
                        };
                        Modal.create(data);
                    }
                }
            }
            function showBuildingCreationModal() {
                let content = "<form enctype='text/plain' id='buildingCreationForm' method='post' action='/' class='w-100'><input type='submit' class='d-none' id='newBuildingSubmit'>";
                content += "<div><label for='newBuildingNameInput' class='col-form-label'>Name:</label>";
                content += "<input type='text' class='form-control' id='newBuildingNameInput' placeholder='Name eingeben' required='required'></div>";
                content += "<div class='mt-3'><label for='newBuildingDescriptionInput' class='col-form-label'>Beschreibung (optional):</label>";
                content += "<input type='text' class='form-control' id='newBuildingDescriptionInput' placeholder='Beschreibung eingeben'></div></form>";
                let data = {
                    name: "buildingCreation",
                    static: true,
                    events: {
                        shown: {
                            function: function() {
                                $("#buildingCreationForm").submit(function() {
                                    saveNewBuilding();
                                    return false;
                                });
                            }
                        },
                        hide: {
                            function: function() {
                                $("#buildingCreationForm").off("submit");
                            }
                        }
                    },
                    title: {
                        text: "Neues Gebäude erstellen"
                    },
                    content: {
                        text: content
                    },
                    footer: {
                        buttons: {
                            default: {
                                text: "Abbrechen",
                                class: "btn-danger"
                            },
                            custom: [
                                {
                                    text: "Speichern",
                                    class: "btn-primary",
                                    attributes: {
                                        id: "saveNewBuildingButton"
                                    },
                                    actions: {
                                        click: {
                                            function: function() {
                                                $("#newBuildingSubmit").click();
                                            }
                                        }
                                    }
                                }
                            ]
                        }
                    }
                };
                Modal.create(data);
            }
            function showBuildingEditingModal(lol) {
                if (DataTable.isDataTable("#buildingsAdminTable")) {
                    let buildings = adminDataTables["buildings"].data().toArray();
                    let index = buildings.findIndex(key => key["id"] === lol);
                    if (index >= 0) {
                        let content = "<form enctype='text/plain' id='buildingEditingForm' method='post' action='/' class='w-100'><input type='submit' class='d-none' id='editBuildingSubmit'>";
                        content += "<div><label for='editBuildingNameInput' class='col-form-label'>Name:</label>";
                        content += "<input type='text' class='form-control' id='editBuildingNameInput' placeholder='Name eingeben' required='required' value='" + buildings[index]["name"] + "'></div>";
                        content += "<div class='mt-3'><label for='editBuildingDescriptionInput' class='col-form-label'>Beschreibung (optional):</label>";
                        content += "<input type='text' class='form-control' id='editBuildingDescriptionInput' placeholder='Beschreibung eingeben' value='" + (!["undefined", "", undefined, null].includes(buildings[index]["description"]) ? buildings[index]["description"] : "") + "'></div></form>";
                        let data = {
                            name: "buildingEditing",
                            static: true,
                            events: {
                                shown: {
                                    function: function() {
                                        $("#buildingEditingForm").submit(function() {
                                            saveEditedBuilding(lol);
                                            return false;
                                        });
                                    }
                                },
                                hide: {
                                    function: function() {
                                        $("#buildingCreationForm").off("submit");
                                    }
                                }
                            },
                            title: {
                                text: "Gebäude &quot;" + buildings[index]["name"] + "&quot; bearbeiten"
                            },
                            content: {
                                text: content
                            },
                            footer: {
                                buttons: {
                                    default: {
                                        text: "Abbrechen",
                                        class: "btn-danger"
                                    },
                                    custom: [
                                        {
                                            text: "Speichern",
                                            class: "btn-primary",
                                            attributes: {
                                                id: "saveEditedBuildingButton"
                                            },
                                            actions: {
                                                click: {
                                                    function: function() {
                                                        $("#editBuildingSubmit").click();
                                                    }
                                                }
                                            }
                                        }
                                    ]
                                }
                            }
                        };
                        Modal.create(data);
                    }
                }
                else {
                    alert("Fehler: Es sind keine Daten vorhanden.");
                }
            }
            function saveEditedBuilding(id) {
                if ($("#mainModal").hasClass("show") && $("#mainModal").attr("data-name") === "buildingEditing") {
                    disableMainModal("#saveEditedBuildingButton");
                    $.post({
                        url: apiURL + "/building/edit",
                        data: JSON.stringify({
                            //token: getCookie("authToken"),
                            token: "C4NQDvFIk8L#^@z!UKUnxXFcCZ5qlt",
                            id: id,
                            name: $("#editBuildingNameInput").val(),
                            description: $("#editBuildingDescriptionInput").val()
                        }),
                        processData: false,
                        contentType: "application/json",
                        crossDomain: true,
                        timeout: 10000
                    }).done(function(response) {
                        bootstrap.Modal.getInstance($("#mainModal")[0]).hide();
                        $("#buildingsAdminTable_wrapper").before(Alert.create("success", "Die Informationen für das Gebäude mit der ID &quot;" + id + "&quot; wurden aktualisiert."));
                        $("#buildingsAdminTable").DataTable().ajax.reload();

                    }).fail(function(response) {
                        $("#mainModal .modal-body").prepend(Alert.create("danger", response["status"] + ": " + response["statusText"]));
                    }).always(function() {
                        enableMainModal("#saveEditedBuildingButton");
                    });
                }
            }
            function saveEditedRoom(id) {
                if ($("#mainModal").hasClass("show") && $("#mainModal").attr("data-name") === "roomEditing") {
                    disableMainModal("#saveEditedRoomButton");
                    $.post({
                        url: apiURL + "/room/edit",
                        data: JSON.stringify({
                            //token: getCookie("authToken"),
                            token: "C4NQDvFIk8L#^@z!UKUnxXFcCZ5qlt",
                            id: id,
                            name: $("#editRoomNameInput").val(),
                            description: $("#editRoomDescriptionInput").val()
                        }),
                        processData: false,
                        contentType: "application/json",
                        crossDomain: true,
                        timeout: 10000
                    }).done(function(response) {
                        bootstrap.Modal.getInstance($("#mainModal")[0]).hide();
                        $("#roomsAdminTable_wrapper").before(Alert.create("success", "Die Informationen für den Raum mit der ID &quot;" + id + "&quot; wurden aktualisiert."));
                        $("#roomsAdminTable").DataTable().ajax.reload();

                    }).fail(function(response) {
                        $("#mainModal .modal-body").prepend(Alert.create("danger", response["status"] + ": " + response["statusText"]));
                    }).always(function() {
                        enableMainModal("#saveEditedRoomButton");
                    });
                }
            }
            function toggleNewReservationTimes(element) {
                if ($("#mainModal").attr("data-name") === "reservationCreation") {
                    if ($(element).prop("checked")) {
                        $("#newReservationTimeToHours").attr("disabled", "disabled");
                        $("#newReservationTimeToMinutes").attr("disabled", "disabled");
                    }
                    else {
                        $("#newReservationTimeToHours").removeAttr("disabled");
                        $("#newReservationTimeToMinutes").removeAttr("disabled");
                    }
                }
            }
            function confirmBuildingDeletion(lol) {
                if (DataTable.isDataTable("#buildingsAdminTable")) {
                    let buildingId = Number.parseInt(lol);
                    let buildings = adminDataTables["buildings"].data().toArray();
                    let index = buildings.findIndex(key => key["id"] === buildingId);
                    if (index >= 0) {
                        let prompt = new Promise(function(resolve) {
                            confirmation({
                                title: "Gebäude entfernen bestätigen",
                                content: "Soll das Gebäude &quot;" + buildings[index]["name"] + "&quot; wirklich gelöscht werden?"
                            }, resolve);
                        });
                        prompt.then(function(value) {
                            disableMainModal("#confirmationButton");
                            $.post({
                                url: apiURL + "/building/delete",
                                data: JSON.stringify({
                                    //token: getCookie("authToken"),
                                    token: "C4NQDvFIk8L#^@z!UKUnxXFcCZ5qlt",
                                    id: buildingId,
                                }),
                                processData: false,
                                contentType: "application/json",
                                crossDomain: true,
                                timeout: 10000
                            }).done(function(response) {
                                bootstrap.Modal.getInstance($("#mainModal")[0]).hide();
                                $("#buildingsAdminTable_wrapper").before(Alert.create("success", "Das Gebäude mit der ID &quot;" + lol + "&quot; wurde gelöscht."));
                                $("#buildingsAdminTable").DataTable().ajax.reload();
                            }).fail(function(response) {
                                $("#mainModal .modal-body").prepend(Alert.create("danger", response["status"] + ": " + response["statusText"]));
                            }).always(function() {
                                enableMainModal("#confirmationButton");
                            });
                        });
                    }
                }
            }
            function confirmBuildingActivation(lol) {
                if (DataTable.isDataTable("#buildingsAdminTable")) {
                    let buildings = adminDataTables["buildings"].data().toArray();
                    let index = buildings.findIndex(key => key["id"] === Number.parseInt(lol));
                    if (index >= 0) {
                        let prompt = new Promise(function(resolve) {
                            confirmation({
                                title: "Gebäude &quot;" + buildings[index]["name"] + "&quot; aktivieren",
                                content: "Soll das Gebäude &quot;" + buildings[index]["name"] + "&quot; wirklich aktiviert werden?"
                            }, resolve);
                        });
                        prompt.then(function(value) {
                            bootstrap.Modal.getInstance($("#mainModal")[0]).hide();
                        });
                    }
                }
            }
            function showBuildingDeactivationModal(lol) {
                if (DataTable.isDataTable("#buildingsAdminTable")) {
                    let buildings = adminDataTables["buildings"].data().toArray();
                    let index = buildings.findIndex(key => key["id"] === lol);
                    if (index >= 0) {
                        let content = "<form enctype='text/plain' id='buildingDeactivationForm' method='post' action='/' class='w-100'><input type='submit' class='d-none' id='disableBuildingSubmit'>";
                        content += "<label for='disableBuildingMessage' class='form-label'>Grund (optional):</label>";
                        content += "<input type='text' class='form-control' id='disableBuildingMessage' placeholder='Grund eingeben'></div></form>";
                        let data = {
                            name: "buildingDeactivation",
                            static: true,
                            size: "lg",
                            events: {
                                show: {
                                    function: function() {
                                        $("#buildingDeactivationForm").prepend(Alert.create("primary", "Sollte ein Gebäude aus gewissen Gründen vorrübergehend nicht genutzt werden können, kann es hier deaktiviert werden. Alle gespeicherten Räume (sowie deren momentanen Reservierungen) des Gebäudes bleiben dabei erhalten.", {closeable: false}));
                                    }
                                },
                                shown: {
                                    function: function() {
                                        $("#buildingDeactivationForm").submit(function() {
                                            disableBuilding(lol);
                                            return false;
                                        });
                                    }
                                },
                                hide: {
                                    function: function() {
                                        $("#buildingDeactivationForm").off("submit");
                                    }
                                }
                            },
                            title: {
                                text: "Gebäude &quot;" + buildings[index]["name"] + "&quot; deaktivieren"
                            },
                            content: {
                                text: content
                            },
                            footer: {
                                buttons: {
                                    default: {
                                        text: "Abbrechen",
                                        class: "btn-danger"
                                    },
                                    custom: [
                                        {
                                            text: "Speichern",
                                            class: "btn-primary",
                                            attributes: {
                                                id: "saveDisabledBuildingButton"
                                            },
                                            actions: {
                                                click: {
                                                    function: function() {
                                                        $("#disableBuildingSubmit").click();
                                                    }
                                                }
                                            }
                                        }
                                    ]
                                }
                            }
                        };
                        Modal.create(data);
                    }
                }
            }
            function disableBuilding(building) {
                if ($("#mainModal").hasClass("show") && $("#mainModal").attr("data-name") === "buildingDeactivation") {
                    disableMainModal("#saveDisabledBuildingButton");
                    $.post({
                        url: "http://127.0.0.1:3000/api/",
                        data: JSON.stringify({
                            token: getCookie("authToken"),
                            building: building,
                            message: $("#disableBuildingMessage").val()
                        }),
                        processData: false,
                        contentType: "application/json",
                        crossDomain: true,
                        timeout: 10000
                    }).done(function(response) {
                        bootstrap.Modal.getInstance($("#mainModal")[0]).hide();
                    }).fail(function(response) {
                        $("#mainModal .modal-body").prepend(Alert.create("danger", response["status"] + ": " + response["statusText"]));
                    }).always(function() {
                        enableMainModal("#saveDisabledBuildingButton");
                    });
                }
            }
            function confirmReservationApproval(lol) {
                if (DataTable.isDataTable("#moderatorReservationTable")) {
                    let data = moderatorDataTables["reservations"].row("[id='moderation-table-reservation-id-" + lol + "']").data();
                    let keys = Object.getOwnPropertyNames(data);
                    let reservationId = Number.parseInt(lol);
                    if (keys.length >= 1) {
                        let prompt = new Promise(function(resolve) {
                            confirmation({
                                title: "Reservierung genehmigen",
                                content: "Soll die Reservierung &quot;" + data["title"] + "&quot; wirklich genehmigt werden?"
                            }, resolve);
                        });
                        prompt.then(function(value) {
                            disableMainModal("#confirmationButton");
                            $.post({
                                url: apiURL + "/calendar/edit",
                                data: JSON.stringify({
                                    //token: getCookie("authToken"),
                                    token: "C4NQDvFIk8L#^@z!UKUnxXFcCZ5qlt",
                                    id: lol,
                                    accepted: true,
                                    editor: getCookie("username"),
                                    declinedReason: ""
                                }),
                                processData: false,
                                contentType: "application/json",
                                crossDomain: true,
                                timeout: 10000
                            }).done(function(response) {
                                bootstrap.Modal.getInstance($("#mainModal")[0]).hide();
                                $("#moderatorReservationTable_wrapper").before(Alert.create("success", "Die Reservierung &quot;" + data["title"] + "&quot; (ID: " + lol + ") wurde genehmigt."));
                                $("#moderatorReservationTable").DataTable().ajax.reload();
                            }).fail(function(response) {
                                $("#mainModal .modal-body").prepend(Alert.create("danger", response["status"] + ": " + response["statusText"]));
                            }).always(function() {
                                enableMainModal("#confirmationButton");
                            });
                        });
                    }
                }
            }
            function confirmReservationRejection(lol) {
                if (DataTable.isDataTable("#moderatorReservationTable")) {
                    let reservationData = moderatorDataTables["reservations"].row("[id='moderation-table-reservation-id-" + lol + "']").data();
                    let keys = Object.getOwnPropertyNames(reservationData);
                    if (keys.length >= 1) {
                        let content = "<form enctype='text/plain' id='rejectReservationForm' method='post' action='/' class='w-100'><input type='submit' class='d-none' id='rejectReservationSubmit'>";
                        content += "Soll die Reservierung &quot;" + reservationData["title"] + "&quot; wirklich abgelehnt werden?";
                        content += "<div><label class='col-form-label me-2' for='rejectReservationReasonInput'>Grund (optional):</label>";
                        content += "<input type='text' class='form-control' id='rejectReservationReasonInput'></div></form>";
                        let data = {
                            name: "reservationRejection",
                            static: true,
                            events: {
                                show: {
                                    function: function() {
                                        $("#rejectReservationForm").submit(function() {
                                            rejectReservation(reservationData["id"]);
                                            return false;
                                        });
                                    }
                                },
                                hide: {
                                    function: function() {
                                        $("#rejectReservationForm").off("submit");
                                    }
                                }
                            },
                            title: {
                                text: "Reservierung ablehnen"
                            },
                            content: {
                                text: content
                            },
                            footer: {
                                buttons: {
                                    default: {
                                        text: "Abbrechen",
                                        class: "btn-danger"
                                    },
                                    custom: [
                                        {
                                            text: "Bestätitgen",
                                            class: "btn-primary",
                                            attributes: {
                                                id: "confirmReservationRejectionButton"
                                            },
                                            actions: {
                                                click: {
                                                    function: function() {
                                                        $("#rejectReservationSubmit").click();
                                                    }
                                                }
                                            }
                                        }
                                    ]
                                }
                            }
                        };
                        Modal.create(data);
                    }
                }
            }
            function rejectReservation(id) {
                disableMainModal("#confirmReservationRejectionButton");
                    $.post({
                        url: apiURL + "/building/edit",
                        data: JSON.stringify({
                            //token: getCookie("authToken"),
                            token: "C4NQDvFIk8L#^@z!UKUnxXFcCZ5qlt",
                            id: id,
                            declinedReason: $("#rejectReservationReasonInput0").val(),
                            accepted: false,
                            editor: getCookie("username")
                        }),
                        processData: false,
                        contentType: "application/json",
                        crossDomain: true,
                        timeout: 10000
                    }).done(function(response) {
                        bootstrap.Modal.getInstance($("#mainModal")[0]).hide();
                        $("#moderatorReservationTable_wrapper").before(Alert.create("success", "Die Informationen für das Gebäude mit der ID &quot;" + id + "&quot; wurden aktualisiert."));
                        $("#moderatorReservationTable").DataTable().ajax.reload();

                    }).fail(function(response) {
                        $("#mainModal .modal-body").prepend(Alert.create("danger", response["status"] + ": " + response["statusText"]));
                    }).always(function() {
                        enableMainModal("#confirmReservationRejectionButton");
                    });
            }
            function saveNewBuilding() {
                if ($("#mainModal").hasClass("show") && $("#mainModal").attr("data-name") === "buildingCreation") {
                    disableMainModal("#saveNewBuildingButton");
                    $.post({
                        url: apiURL + "/building/add",
                        data: JSON.stringify({
                            //token: getCookie("authToken"),
                            token: "C4NQDvFIk8L#^@z!UKUnxXFcCZ5qlt",
                            name: $("#newBuildingNameInput").val(),
                            description: $("#newBuildingDescriptionInput").val()
                        }),
                        processData: false,
                        contentType: "application/json",
                        crossDomain: true,
                        timeout: 10000
                    }).done(function(response) {
                        bootstrap.Modal.getInstance($("#mainModal")[0]).hide();
                        $("#buildingsAdminTable_wrapper").before(Alert.create("success", "Das neue Gebäude namens &quot;" + $("#newBuildingDescriptionInput").val() + "&quot; wurde hinzugefügt."));
                        $("#buildingsAdminTable").DataTable().ajax.reload();
                    }).fail(function(response) {
                        $("#mainModal .modal-body").prepend(Alert.create("danger", response["status"] + ": " + response["statusText"]));
                    }).always(function() {
                        enableMainModal("#saveNewBuildingButton");
                    });
                }
            }
            function saveNewRoom() {
                if ($("#mainModal").hasClass("show") && $("#mainModal").attr("data-name") === "roomCreation") {
                    disableMainModal("#saveNewRoomButton");
                    $.post({
                        url: apiURL + "/room/add",
                        data: JSON.stringify({
                            //token: getCookie("authToken"),
                            token: "C4NQDvFIk8L#^@z!UKUnxXFcCZ5qlt",
                            building_id: $("#newRoomBuildingSelect").val(),
                            name: $("#newRoomNameInput").val(),
                            description: $("#newRoomDescriptionInput").val()
                        }),
                        processData: false,
                        contentType: "application/json",
                        crossDomain: true,
                        timeout: 10000
                    }).done(function(response) {
                        let indexBuilding = buildings.findIndex(key => key["id"] === Number.parseInt($("#newRoomBuildingSelect").val()));
                        bootstrap.Modal.getInstance($("#mainModal")[0]).hide();
                        $("#roomsAdminTable_wrapper").before(Alert.create("success", "Der neue Raum namens &quot;" + $("#newRoomNameInput").val() + "&quot; wurde zu Gebäude &quot;" + buildings[indexBuilding]["name"] + "&quot; (ID: " + buildings[indexBuilding]["id"] + ") hinzugefügt."));
                        $("#roomsAdminTable").DataTable().ajax.reload();
                    }).fail(function(response) {
                        $("#mainModal .modal-body").prepend(Alert.create("danger", response["status"] + ": " + response["statusText"]));
                    }).always(function() {
                        enableMainModal("#saveNewRoomButton");
                    });
                }
            }
            function saveNewReservation(startDate, endDate) {
                if ($("#mainModal").hasClass("show") && $("#mainModal").attr("data-name") === "reservationCreation") {
                    disableMainModal("#saveNewReservationButton");
                    let start = new Date(startDate);
                    let end = new Date(endDate);
                    console.log(start, end);
                    start.setHours(Number.parseInt($("#newReservationTimeFromHours").val()), Number.parseInt($("#newReservationTimeFromMinutes").val()));
                    end.setHours(Number.parseInt($("#newReservationTimeToHours").val()), Number.parseInt($("#newReservationTimeToMinutes").val()));
                    // datumsprüfung ist sache des servers
                    $.post({
                        url: apiURL + "/calendar/add",
                        data: JSON.stringify({
                            token: "C4NQDvFIk8L#^@z!UKUnxXFcCZ5qlt", // getCookie("authToken")
                            start: start.getTime(),
                            end: end.getTime(),
                            room_id: Number.parseInt($("#newReservationRoomSelect").val()),
                            title: $("#newReservationDescriptionInput").val(),
                            showName: $("#newReservationDescriptionHiddenCheckbox").prop("checked")
                        }),
                        processData: false,
                        contentType: "application/json",
                        crossDomain: true,
                        timeout: 10000
                    }).done(function(response) {
                        bootstrap.Modal.getInstance($("#mainModal")[0]).hide();
                        $("#calendarLocationForm").before(Alert.create("success", "Die Reservierung wurde eingereicht. Ein Moderator wird sie zur gegebenen Zeit prüfen."));
                        calendar.refetchEvents();
                    }).fail(function(response) {
                        $("#mainModal .modal-body").prepend(Alert.create("danger", response["status"] + ": " + response["statusText"]));
                    }).always(function() {
                        enableMainModal("#saveNewReservationButton");
                    });
                }
            }
            function getReservations(start, end, successCallback, failureCallback) {
                if ($("#calendarLocationSubmit").find("[data-processing='true']").length === 0) {
                        $("#calendarLocationSubmit").prepend("<span data-processing='true' class='spinner-border me-1 text-white kreiselchen align-text-bottom'></span>");
                }
                $("#calendarLocationSubmit").attr("disabled", "disabled");
                $.post({
                    url: apiURL + "/calendar/list",
                    data: JSON.stringify({
                        //building: $("#buildingSelection").val(),
                        room: $("#roomSelection").val(),
                        start: start,
                        end: end
                    }),
                    processData: false,
                    contentType: "application/json",
                    crossDomain: true,
                    timeout: 10000
                }).done(function(response) {
                    successCallback(response);
                }).fail(function(response) {
                    failureCallback(response["status"] + ": " + response["statusText"]);
                    $("#calendarLocationForm").before(Alert.create("danger", response["status"] + ": " + response["statusText"]));
                }).always(function() {
                    isGettingReservations = false;
                    $("#calendarLocationSubmit").find("[data-processing='true']").remove();
                    $("#calendarLocationSubmit").removeAttr("disabled");
                });
            }
            function loadRooms(source, target) {
                $(target).empty();
                let roomId = Number.parseInt($(source).val());
                for (room of rooms) {
                    if (room["buildingid"] === roomId) {
                        $(target).append("<option value='" + room["id"] + "'>" + room["name"] + "</option>");
                    }
                }
                $(target).prop("selectedIndex", 0);
            }
            function formatDate(time, options) {
                if (Number.isSafeInteger(time)) {
                    let dateString = "";
                    let date = new Date(time);
                    if (options.includes("date") && !options.includes("time")) {
                        dateString = ("00" + (date.getDate()).toString()).substr(-2, 2) + "." + ("00" + (date.getMonth() +1).toString()).substr(-2, 2) + "." + date.getFullYear();
                    }
                    else if (!options.includes("date") && options.includes("time")) {
                        dateString = ("00" + (date.getHours().toString())).substr(-2, 2) + ":" + ("00" + (date.getMinutes().toString())).substr(-2, 2) + ":" + ("00" + (date.getSeconds().toString())).substr(-2, 2);
                    }
                    else if (options.includes("date") && options.includes("time")) {
                        dateString = ("00" + (date.getDate()).toString()).substr(-2, 2) + "." + ("00" + (date.getMonth() +1).toString()).substr(-2, 2) + "." + date.getFullYear() + ", " + ("00" + (date.getHours().toString())).substr(-2, 2) + ":" + ("00" + (date.getMinutes().toString())).substr(-2, 2) + ":" + ("00" + (date.getSeconds().toString())).substr(-2, 2);
                    }
                    return dateString;
                }
            }
            function loadBuildings(target) {
                $(target).empty();
                for (building of buildings) {
                    $(target).append("<option value='" + building["id"] + "'>" + building["name"] + "</option>");
                }
            }
            function showReservationCreationModal() {
                let startDate = Number.parseInt($("#showReservationCreationModalButton").attr("data-start"));
                let endDate = Number.parseInt($("#showReservationCreationModalButton").attr("data-end"));
                if (Number.isSafeInteger(startDate) && Number.isSafeInteger(endDate)) {
                    let content = "<form enctype='text/plain' id='reservationCreationForm' method='post' action='/' class='w-100'><input type='submit' class='d-none' id='newReservationSubmit'>";
                    content += "<div><label class='col-form-label' for='newReservationBuildingSelect'>Gebäude:</label>";
                    content += "<select class='form-select' id='newReservationBuildingSelect' onchange='loadRooms(this, &quot;#newReservationRoomSelect&quot;)' required='required'></select></div>";
                    content += "<div class='mt-3'><label class='col-form-label' for='newReservationRoomSelect'>Raum:</label>";
                    content += "<select class='form-select' id='newReservationRoomSelect' required='required'></select></div>";
                    content += "<div class='mt-3'><label class='col-form-label' for='newReservationDescriptionInput'>Beschreibung:</label>";
                    content += "<div class='input-group'><input type='text' class='form-control' id='newReservationDescriptionInput' required='required'>";
                    content += "<div class='d-flex align-items-center align-content-center input-group-text'><input class='form-check-input mt-0' type='checkbox' id='newReservationDescriptionHiddenCheckbox' value='1'>";
                    content += "<label class='form-check-label ps-1' for='newReservationDescriptionHiddenCheckbox'>Ausblenden</label></div></div></div>";
                    content += "<div class='mt-3'><label class='col-form-label' for='newReservationTimeFromHours'>Start:</label>";
                    content += "<div class='d-flex align-items-center align-content-center'><div class='input-group' style='flex: 0 0 33%'><input type='text' class='form-control' onblur='checkHours(this)' maxlength='2' id='newReservationTimeFromHours' value='0' required='required'>";
                    content += "<span class='input-group-text'>:</span><input type='text' class='form-control' onblur='checkMinutes(this)' maxlength='2' id='newReservationTimeFromMinutes' value='0' required='required'></div>";
                    content += "<label class='ms-2' for='newReservationTimeFromMinutes'>Uhr</label></div></div>";
                    content += "<div class='mt-3'><label class='col-form-label' for='newReservationTimeToHours'>Ende:</label>";
                    content += "<div class='d-flex align-items-center align-content-center'><div class='input-group' style='flex: 0 0 33%'><input type='text' class='form-control' onblur='checkHours(this)' maxlength='2' id='newReservationTimeToHours' required='required'>";
                    content += "<span class='input-group-text'>:</span><input type='text' class='form-control' onblur='checkMinutes(this)' maxlength='2' id='newReservationTimeToMinutes' required='required'></div>";
                    content += "<label class='ms-2' for='newReservationTimeToMinutes'>Uhr</label></div>";
                    content += "</div></div></form>";
                    let data = {
                        name: "reservationCreation",
                        static: true,
                        events: {
                            shown: {
                                function: function() {
                                    loadBuildings("#newReservationBuildingSelect");
                                    $("#newReservationBuildingSelect").prop("selectedIndex", 0).change();
                                    $("#reservationCreationForm").submit(function() {
                                        saveNewReservation(startDate, endDate);
                                        return false;
                                    });
                                }
                            },
                            hide: {
                                function: function() {
                                    $("#reservationCreationForm").off("submit");
                                }
                            }
                        },
                        title: {
                            text: "Neuen Termin erstellen am " + formatDate(startDate, ["date"])
                        },
                        content: {
                            text: content
                        },
                        footer: {
                            buttons: {
                                default: {
                                    text: "Abbrechen",
                                    class: "btn-danger"
                                },
                                custom: [
                                    {
                                        text: "Speichern",
                                        class: "btn-primary",
                                        attributes: {
                                            id: "saveNewReservationButton"
                                        },
                                        actions: {
                                            click: {
                                                function: function() {
                                                    $("#newReservationSubmit").click();
                                                }
                                            }
                                        }
                                    }
                                ]
                            }
                        }
                    };
                    Modal.create(data);
                }
            }
            function showAdminReservationEditingModal(id) {
                if (DataTable.isDataTable("#reservationAdminTable")) {
                    let reservationData = adminDataTables["reservations"].row("[id='administration-table-reservation-id-" + id + "']").data();
                    console.log(reservationData);
                    let keys = Object.getOwnPropertyNames(reservationData);
                    if (keys.length >= 1) {
                        let content = "<form enctype='text/plain' id='reservationAdminEditingForm' method='post' action='/' class='w-100'><input type='submit' class='d-none' id='editAdminReservationSubmit'>";
                        content += "<div><label class='col-form-label' for='editAdminReservationBuildingSelect'>Gebäude:</label>";
                        content += "<select class='form-select' id='editAdminReservationBuildingSelect' onchange='loadRooms(this, &quot;#editAdminReservationRoomSelect&quot;)' required='required'></select></div>";
                        content += "<div class='mt-3'><label class='col-form-label' for='editAdminReservationRoomSelect'>Raum:</label>";
                        content += "<select class='form-select' id='editAdminReservationRoomSelect' required='required'></select></div>";
                        content += "<div class='mt-3'><label class='col-form-label' for='editAdminReservationDescriptionInput'>Beschreibung:</label>";
                        content += "<div class='input-group'><input type='text' class='form-control' id='editAdminReservationDescriptionInput' required='required' value='" + reservationData["title"] + "'>";
                        content += "<div class='d-flex align-items-center align-content-center input-group-text'><input class='form-check-input mt-0' type='checkbox' id='editAdminReservationDescriptionHiddenCheckbox' value='1'>";
                        content += "<label class='form-check-label ps-1' for='editAdminReservationDescriptionHiddenCheckbox'>Ausblenden</label></div></div></div>";
                        content += "<div class='mt-3'><label class='col-form-label' for='editAdminReservationStatusSelect'>Status:</label>";
                        content += "<select class='form-select' id='editAdminReservationStatusSelect' required='required' value='" + reservationData["accepted"] + "'>";
                        content += "<option value='0'>Abgelehnt</option><option value='1'>Angenommen</option></select></div>";
                        content += "<div class='mt-3'><label class='col-form-label' for='editAdminReservationTimeFromHours'>Start:</label>";
                        content += "<div class='d-flex align-items-center align-content-center'><div class='input-group' style='flex: 0 0 33%'><input type='text' class='form-control' onblur='checkHours(this)' maxlength='2' id='editAdminReservationTimeFromHours' value='0' required='required'>";
                        content += "<span class='input-group-text'>:</span><input type='text' class='form-control' onblur='checkMinutes(this)' maxlength='2' id='editAdminReservationTimeFromMinutes' value='0' required='required'></div>";
                        content += "<label class='ms-2' for='editAdminReservationTimeFromMinutes'>Uhr</label></div></div>";
                        content += "<div class='mt-3'><label class='col-form-label' for='editAdminReservationTimeToHours'>Ende:</label>";
                        content += "<div class='d-flex align-items-center align-content-center'><div class='input-group' style='flex: 0 0 33%'><input type='text' class='form-control' onblur='checkHours(this)' maxlength='2' id='editAdminReservationTimeToHours' required='required'>";
                        content += "<span class='input-group-text'>:</span><input type='text' class='form-control' onblur='checkMinutes(this)' maxlength='2' id='editAdminReservationTimeToMinutes' required='required'></div>";
                        content += "<label class='ms-2' for='editAdminReservationTimeToMinutes'>Uhr</label></div>";
                        content += "</div></div></form>";
                        let data = {
                            name: "reservationAdminEditing",
                            static: true,
                            events: {
                                shown: {
                                    function: function() {
                                        loadBuildings("#editAdminReservationBuildingSelect");
                                        let index = rooms.findIndex(key => key["id"] === reservationData["roomid"]);
                                        if (index >= 0) {
                                            $("#editAdminReservationBuildingSelect").val(rooms[index]["buildingid"]).change();
                                            $("#editAdminReservationRoomSelect").val(reservationData["roomid"]);
                                        }
                                        $("#reservationAdminEditingForm").submit(function() {
                                            saveAdminEditedReservation(reservationData["id"]);
                                            return false;
                                        });
                                    }
                                },
                                hide: {
                                    function: function() {
                                        $("#reservationAdminEditingForm").off("submit");
                                    }
                                }
                            },
                            title: {
                                text: "Reservierung bearbeiten"
                            },
                            content: {
                                text: content
                            },
                            footer: {
                                buttons: {
                                    default: {
                                        text: "Abbrechen",
                                        class: "btn-danger"
                                    },
                                    custom: [
                                        {
                                            text: "Speichern",
                                            class: "btn-primary",
                                            attributes: {
                                                id: "saveAdminEditedReservationButton"
                                            },
                                            actions: {
                                                click: {
                                                    function: function() {
                                                        $("#editAdminReservationSubmit").click();
                                                    }
                                                }
                                            }
                                        }
                                    ]
                                }
                            }
                        };
                        Modal.create(data);
                    }
                }
            }
            function saveAdminEditedReservation(id) {
                if ($("#mainModal").hasClass("show") && $("#mainModal").attr("data-name") === "reservationAdminEditing") {
                    $.post({
                        url: apiURL + "/calendar/edit",
                        data: JSON.stringify({
                            //token: getCookie("authToken"),
                            token: "C4NQDvFIk8L#^@z!UKUnxXFcCZ5qlt",
                            id: $("#newBuildingNameInput").val(),
                            title: $("#editAdminReservationDescriptionInput").val()
                        }),
                        processData: false,
                        contentType: "application/json",
                        crossDomain: true,
                        timeout: 10000
                    }).done(function(response) {
                        bootstrap.Modal.getInstance($("#mainModal")[0]).hide();
                        $("#buildingsAdminTable_wrapper").before(Alert.create("success", "Das neue Gebäude namens &quot;" + $("#newBuildingDescriptionInput").val() + "&quot; wurde hinzugefügt."));
                        $("#buildingsAdminTable").DataTable().ajax.reload();
                    }).fail(function(response) {
                        $("#mainModal .modal-body").prepend(Alert.create("danger", response["status"] + ": " + response["statusText"]));
                    }).always(function() {
                        enableMainModal("#saveNewBuildingButton");
                    });
                }
            }
            Number.prototype.duration = function() {
                let sec_num = parseInt(this, 10);
                let weeks = Math.floor((sec_num / 3600 / 24) / 7);
                let days = Math.floor((sec_num / 3600 / 24) % 7);
                let hours = Math.floor((sec_num / 3600) % 24);
                let minutes = Math.floor((sec_num / 60) % 60);
                let seconds = sec_num % 60;
                let duration = "";
                if (weeks >= 1) {
                    duration += weeks + (weeks >= 2 ? " Wochen, " : " Woche, ");
                }
                if (days >= 1) {
                    duration += days + (days >= 2 ? " Tage, " : " Tag, ");
                }
                if (hours >= 1) {
                    duration += hours + (hours >= 2 ? " Stunden, " : " Stunde, ");
                }
                if (minutes >= 1) {
                    duration += minutes + (minutes >= 2 ? " Minuten, " : " Minute, ");
                }
                if (seconds >= 1) {
                    duration += seconds + (seconds >= 2 ? " Sekunden, " : " Sekunde, ");
                }
                return duration.substr(0, duration.length -2);
            }
            $(window).on("load", function() {
                $("#body-overlay").empty();
                $("#body-overlay").css("opacity", 0).on("transitionend", function() {
                    $(this).remove();
                    $("body").removeClass("overflow-hidden");
                });
                viewportWidth = visualViewport["width"];
            }).on("resize", function() {
                if (visualViewport["width"] !== viewportWidth) {
                    viewportWidth = visualViewport["width"];
                }
            });
            $(document).on("DOMContentLoaded", function() {
                calendar = new FullCalendar.Calendar($("#reservationCalendar")[0], {
                    initialView: "dayGridMonth",
                    locale: "de",
                    events: "calendar.php",
                    selectable: true,
                    selectAllow: function(selectInfo) {
                        let currentDate = new Date();
                        currentDate.setHours(0, 0, 0);
                        return selectInfo["start"].getTime() >= currentDate.getTime();
                    },
                    events: function(info, successCallback, failureCallback) {
                        if (firstRun) {
                            firstRun = false;
                            successCallback({});
                        }
                        else {
                            if (!isGettingReservations) {
                                isGettingReservations = true;
                                setTimeout(getReservations, 500, info["startStr"], info["endStr"], successCallback, failureCallback);
                            }
                        }
                    },
                    select: function(selectionInfo) {
                        console.log(selectionInfo["end"].setHours(selectionInfo["end"].getHours() -24));
                        let currentDate = new Date();
                        currentDate.setHours(0, 0, 0);
                        if (buildings.length >= 1) {
                            if (selectionInfo["start"].getTime() >= currentDate.getTime()) {
                                $("#showReservationCreationModalButton").removeAttr("disabled").attr({"data-start": selectionInfo["start"].getTime(), "data-end": (selectionInfo["end"].setHours(selectionInfo["end"].getHours() -0))}).removeClass("disabled");
                            }
                            else {
                                $("#showReservationCreationModalButton").attr("disabled", "disabled").addClass("disabled");
                            }
                        }
                    },
                    eventDisplay: "block",
                    eventClick: function(info) {
                        let startDate = new Date(Number.parseInt(info["event"]["_def"]["extendedProps"]["start"]));
                        let endDate = new Date(Number.parseInt(info["event"]["_def"]["extendedProps"]["end"]));
                        $("#selectedReservationDescription").html(info["event"]["_def"]["title"]);
                        $("#selectedReservationOrganiser").html(info["event"]["_def"]["extendedProps"]["organiser"]);
                        $("#selectedReservationStart").html(formatDate(startDate.getTime(), ["date", "time"]) + " Uhr");
                        $("#selectedReservationEnd").html(formatDate(endDate.getTime(), ["date", "time"]) + " Uhr");
                    },
                    eventsSet: function(events) {
                        $("#calendarLocationSubmit").removeAttr("disabled");
                    },
                    unselectAuto: false
                });
                calendar.render();
                getBuildings();
                getRooms();
                let date = new Date();
                $("footer").html("<a href='#about'>&copy; 2021-" + date.getFullYear() + " BSDGG/IN20/FIAE</a>");
                $("a[href='#about']").click(function() {
                    let content = "<p>&quot;Terminator&quot; ist eine dynamische Webseite zur einfachen Reservierung von Räumen und wurde von den Profis der Klasse IN20 im Bereich der Anwendungsentwicklung erstellt.</p><p>Bei Fragen oder Problemen kontaktieren Sie bitte wtf?</p>";
                    let data = {
                        name: "about",
                        title: {
                            text: "Über Terminator"
                        },
                        content: {
                            text: content
                        }
                    }
                    Modal.create(data);
                });
                $("#calendarLocationForm").submit(function() {
                    calendar.refetchEvents();
                    return false;
                });
                $("a[href='#systemInfos']").click(function () {
                    let content = "<table class='table-sm w-100'><thead>";
                    content += "<tr><th class='w-40'>Eigenschaft</th><th>Wert</th></tr>";
                    content += "</thead><tbody id='systemInfosTable'></tbody></table>";
                    let data = {
                        name: 'systemInfos',
                        size: 'lg',
                        events: {
                            hide: {
                                function: function (a) {
                                    if (systemInfosTimer !== null) {
                                        clearInterval(systemInfosTimer);
                                        systemInfosTimer = null;
                                    }
                                },
                            },
                            shown: {
                                function: function (o) {
                                    updateSystemInfos();
                                    systemInfosTimer = setInterval(updateSystemInfos, 5000);
                                },
                            },
                        },
                        title: {
                            text: 'Systeminformationen',
                        },
                        content: {
                            text: content,
                            options: {
                                scroll: true,
                            },
                        },
                    };
                    Modal.create(data);
                });
                $("a[href='#logout']").click(function() {
                    //wtf?
                });

                $("a[href='#reservationsOverview']").on("shown.bs.tab", function() {
                    if (buildings.length === 0 && $("#calendar #noBuildingsFoundWarning").length === 0) {
                        $("#calendarLocationForm").before(Alert.create("warning", "Es wurden keine Gebäude in der Datenbank gefunden, für die Reservierungen angezeigt werden können. Wenden Sie sich an einen für diese Seite zuständigen Administrator, damit dieses Problem behoben werden kann.", {id: "moderationNoBuildingsFoundWarning", closeable: false}));
                    }
                    else {
                        $("#noBuildingsFoundWarning").remove();
                    }
                    if ($("#calendar").hasClass("active") && calendar !== null) {
                        calendar.updateSize();
                    }
                });
                $("a[href='#calendar']").on("shown.bs.tab", function() {
                    if (calendar !== null) {
                        calendar.updateSize();
                    }
                });
                $("a[href='#myReservations']").on("shown.bs.tab", function() {
                    if (!DataTable.isDataTable("#myReservationTable")) {
                        $("#myReservationsReloadButton").attr("disabled", "disabled");
                        $("#myReservationStatusSelect").val("0");
                        let options = {};
                        Object.assign(options, dataTablesOptions["myReservations"]);
                        options["rowGroup"] = {
                            dataSrc: "status",
                            className: "bg-gray-200"
                        };
                        options["orderFixed"] = [5, "asc"];
                        dataTables["myReservations"] = $("#myReservationTable").DataTable(options).on("draw.dt", function(settings) {
                            $("#myReservationsReloadButton").removeAttr("disabled").find("[data-processing='true']").remove();
                        });
                    }
                });
                $("a[href='#moderation']").on("shown.bs.tab", function() {
                    if (!DataTable.isDataTable("#moderatorReservationTable")) {
                        $("#reservationsModeratorReloadButton").attr("disabled", "disabled");
                        loadBuildings("#moderationBuildingSelect");
                        $("#moderationBuildingSelect").prepend("<option value='0'>Alle</option>").val("0");
                        let options = {};
                        Object.assign(options, dataTablesModeratorOptions["reservations"]);
                        options["rowGroup"] = {
                            dataSrc: "buildingid",
                            className: "bg-gray-200",
                            endRender: null,
                            startRender: function(rows, group) {
                                let index = buildings.findIndex(key => key["id"] === group);
                                return $("<tr>").append("<td colspan='7' class='align-middle' style='color: #282828'>" + (index >= 0 ? buildings[index]["name"] : "Unbekannte Gebäude-ID: " + group) + "</td>");
                            }
                        };
                        options["orderFixed"] = [1, "asc"];
                        moderatorDataTables["reservations"] = $("#moderatorReservationTable").DataTable(options).on("draw.dt", function(settings) {
                            $("#reservationsModeratorReloadButton").removeAttr("disabled").find("[data-processing='true']").remove();
                        });
                    }
                });
                $("a[href='#administration']").on("shown.bs.tab", function() {
                    if (visualViewport["width"] != viewportWidth) {
                        readjustTables();
                    }
                });
                $("#reservation-accordion").on("shown.bs.collapse", function() {
                    if (!DataTable.isDataTable("#administratorReservationTable")) {
                        loadBuildings("#reservationBuildingSelect");
                        $("#reservationsAdminReloadButton").attr("disabled", "disabled");
                        $("#reservationBuildingSelect").prepend("<option value='0'>Alle</option>").val("0");
                        let options = {};
                        Object.assign(options, dataTablesAdminOptions["reservations"]);
                        options["rowGroup"] = {
                            dataSrc: "buildingid",
                            className: "bg-gray-200",
                            endRender: null,
                            startRender: function(rows, group) {
                                let index = buildings.findIndex(key => key["id"] === group);
                                return $("<tr>").append("<td colspan='9' class='align-middle' style='color: #282828'>" + (index >= 0 ? buildings[index]["name"] : "Unbekannte Gebäude-ID: " + group) + "</td>");
                            }
                        };
                        options["orderFixed"] = [1, "asc"];
                        adminDataTables["reservations"] = $("#reservationAdminTable").DataTable(options).on("draw.dt", function(settings) {
                            $("#reservationsAdminReloadButton").removeAttr("disabled").find("[data-processing='true']").remove();
                        });
                    }
                });
                $("#buildings-accordion").on("shown.bs.collapse", function() {
                    if (!DataTable.isDataTable("#buildingsAdminTable")) {
                        $("#buildingsAdminReloadButton").attr("disabled", "disabled");
                            adminDataTables["buildings"] = $("#buildingsAdminTable").DataTable(dataTablesAdminOptions["buildings"]).on("draw.dt", function(settings) {
                                $("#buildingsAdminReloadButton").removeAttr("disabled").find("[data-processing='true']").remove();
                        });
                    }
                });
                $("#rooms-accordion").on("shown.bs.collapse", function() {
                    if (!DataTable.isDataTable("#roomsAdminTable")) {
                        loadBuildings("#roomsBuildingSelect");
                        $("#roomsAdminReloadButton").attr("disabled", "disabled");
                        $("#roomsBuildingSelect").prepend("<option value='0'>Alle</option>").val("0");
                        let options = {};
                        Object.assign(options, dataTablesAdminOptions["rooms"]);
                        options["rowGroup"] = {
                            dataSrc: "buildingid",
                            className: "bg-gray-200",
                            endRender: null,
                            startRender: function(rows, group) {
                                let index = buildings.findIndex(key => key["id"] === Number.parseInt(group));
                                return $("<tr>").append("<td colspan='3' class='align-middle' style='color: #282828'>" + (index >= 0 ? buildings[index]["name"] : "(Unbekannte Gebäude-ID: " + group + ")") + "</td><td><button class='btn btn-sm btn-success' onclick='showRoomCreationModal(" + group + ")'><i class='fa-solid fa-asterisk'></i> Neu...</button></td>");
                            }
                        };
                        options["orderFixed"] = [1, "asc"];
                        adminDataTables["rooms"] = $("#roomsAdminTable").DataTable(options).on("draw.dt", function(settings) {
                            if (!adminDataTables["rooms"].rowGroup().enabled()) {
                                if (!adminDataTables["rooms"].rowGroup().enabled()) {
                                    if ($("#showRoomCreationModalButton").length === 0) {
                                        $("#roomsAdminTable_wrapper > .row:last-of-type").before("<div class='d-flex justify-content-end mt-3 mb-3'><button type='button' class='btn btn-success' onclick='showRoomCreationModal()' id='showRoomCreationModalButton'><i class='fa-solid fa-asterisk'></i> Neu...</button></div>");
                                    }
                                }
                                else {
                                    $("#showRoomCreationModalButton").remove();
                                }
                            }
                            $("#roomsAdminReloadButton").removeAttr("disabled").find("[data-processing='true']").remove();
                        });
                    }
                });
                $('#collapse-logs').on('shown.bs.collapse', function () {
                    if (!DataTable.isDataTable('#logsAdminTable')) {
                        $("#logsAdminReloadButton").attr("disabled", "disabled");
                        adminDataTables["logs"] = $("#logsAdminTable").DataTable(dataTablesAdminOptions["logs"]).on("draw.dt", function(settings) {
                            $("#logsAdminReloadButton").removeAttr("disabled").find("[data-processing='true']").remove();
                        });
                    }
                });
                /*
                $("#roles-accordion").on("shown.bs.collapse", function() {
                    if (!DataTable.isDataTable("#rolesAdminTable")) {
                        $("#rolesRoleSelect").val("0");
                        let options = {};
                        Object.assign(options, dataTablesAdminOptions["roles"]);
                        options["rowGroup"] = {
                            dataSrc: "role",
                            className: "bg-gray-200",
                            endRender: null,
                            startRender: function(rows, group) {
                                return $("<tr>").append("<td colspan='2' class='align-middle' style='color: #282828'>" + group + "</td><td><button class='btn btn-sm btn-success' onclick='showRoleCreationModal(" + group + ")'><i class='fa-solid fa-asterisk'></i> Neu...</button></td>");
                            }
                        };
                        options["orderFixed"] = [2, "asc"];
                        adminDataTables["roles"] = $("#rolesAdminTable").DataTable(options).on("draw.dt", function(settings) {
                            if (!adminDataTables["roles"].rowGroup().enabled()) {
                                if ($("#showRoleCreationModalButton").length === 0) {
                                    $("#rolesAdminTable_wrapper > .row:last-of-type").before("<div class='d-flex justify-content-end mt-3 mb-3'><button type='button' class='btn btn-success' onclick='showRoleCreationModal()' id='showRoleCreationModalButton'><i class='fa-solid fa-asterisk'></i> Neu...</button></div>");
                                }
                            }
                            else {
                                $("#showRoleCreationModalButton").remove();
                            }
                        });
                    }
                    else {
                        $("#rolesAdminTable").DataTable().ajax.reload();
                    }
                });
                $("#rolesRoleSelect").change(function() {
                    let options = {};
                    let value = Number.parseInt($(this).val());
                    Object.assign(options, dataTablesAdminOptions["roles"]);
                    if (Number.parseInt($(this).attr("data-old")) >= 1 && value <= 0) {
                        options["rowGroup"] = {
                            dataSrc: "role",
                            className: "bg-gray-200",
                            endRender: null,
                            startRender: function(rows, group) {
                                return $("<tr>").append("<td colspan='2' class='align-middle' style='color: #282828'>" + group + "</td><td><button class='btn btn-sm btn-success' onclick='showRoleCreationModal(" + group + ")'><i class='fa-solid fa-asterisk'></i> Neu...</button></td>");
                            }
                        };
                        options["orderFixed"] = [2, "asc"];
                    }
                    options["destroy"] = true;
                    if (value >= 1) {
                        options["ajax"]["data"]["category"] = value;
                    }
                    else {
                        delete options["ajax"]["data"]["category"];
                    }
                    $(this).attr("data-old", value);
                    adminDataTables["roles"] = $("#rolesAdminTable").DataTable(options).on("draw.dt", function(settings) {
                        if (!adminDataTables["roles"].rowGroup().enabled()) {
                            if ($("#showRoleCreationModalButton").length === 0) {
                                $("#rolesAdminTable_wrapper > .row:last-of-type").before("<div class='d-flex justify-content-end mt-3 mb-3'><button type='button' class='btn btn-success' onclick='showRoleCreationModal()' id='showRoleCreationModalButton'><i class='fa-solid fa-asterisk'></i> Neu...</button></div>");
                            }
                        }
                        else {
                            $("#createUserButton").remove();
                        }
                    });
                });*/
                $("#roomsBuildingSelect").change(function() {
                    let options = {};
                    let value = Number.parseInt($(this).val());
                    Object.assign(options, dataTablesAdminOptions["rooms"]);
                    if (Number.parseInt($(this).attr("data-old")) >= 1 && value <= 0) {
                        options["rowGroup"] = {
                            dataSrc: "buildingid",
                            className: "bg-gray-200",
                            endRender: null,
                            startRender: function(rows, group) {
                                let index = buildings.findIndex(key => key["id"] === group);
                                return $("<tr>").append("<td colspan='3' class='align-middle' style='color: #282828'>" + (index >= 0 ? buildings[index]["name"] : "(Unbekannte Gebäude-ID: " + group + ")") + "</td><td><button class='btn btn-sm btn-success' onclick='showRoomCreationModal(" + group + ")'><i class='fa-solid fa-asterisk'></i> Neu...</button></td>");
                            }
                        };
                        options["orderFixed"] = [0, "asc"];
                    }
                    options["destroy"] = true;
                    if (value >= 1) {
                        options["ajax"]["data"]["building_id"] = value;
                    }
                    else {
                        delete options["ajax"]["data"]["building_id"];
                    }
                    $(this).attr("data-old", value);
                    $("#roomsAdminTable").off("draw.dt");
                    adminDataTables["roomsAdminTable"] = $("#roomsAdminTable").DataTable(options).on("draw.dt", function(settings) {
                        if (!adminDataTables["rooms"].rowGroup().enabled()) {
                            if ($("#roomsAdminActions > #showRoomCreationModalButton").length === 0) {
                                $("#roomsAdminActions").append("<button type='button' class='btn btn-success' onclick='showRoomCreationModal()' id='showRoomCreationModalButton'><i class='fa-solid fa-asterisk'></i> Neu...</button>");
                            }
                        }
                        else {
                            $("#showRoomCreationModalButton").remove();
                        }
                        $("#roomsAdminReloadButton").removeAttr("disabled").find("[data-processing='true']").remove();
                    });
                });
                $("#reservationBuildingSelect").change(function() {
                    let options = {};
                    let value = Number.parseInt($(this).val());
                    Object.assign(options, dataTablesAdminOptions["reservations"]);
                    if (Number.parseInt($(this).attr("data-old")) >= 1 && value <= 0) {
                        options["rowGroup"] = {
                            dataSrc: "building",
                            className: "bg-gray-200",
                            endRender: null,
                            startRender: function(rows, group) {
                                let index = buildings.findIndex(key => key["id"] === group);
                                return $("<tr>").append("<td colspan='3' class='align-middle' style='color: #282828'>" + (index >= 0 ? buildings[index]["name"] : "(Unbekannte Gebäude-ID: " + group + ")") + "</td><td><button class='btn btn-sm btn-success' onclick='showRoomCreationModal(" + group + ")'><i class='fa-solid fa-asterisk'></i> Neu...</button></td>");
                            }
                        };
                        options["orderFixed"] = [0, "asc"];
                    }
                    options["destroy"] = true;
                    if (value >= 1) {
                        options["ajax"]["data"]["category"] = value;
                    }
                    else {
                        delete options["ajax"]["data"]["category"];
                    }
                    $(this).attr("data-old", value);
                    //$("#reservationsAdminTable").off("draw.dt");
                    //adminDataTables["reservationsAdminTable"] = $("#reservationsAdminTable").DataTable(options).on("draw.dt", function(settings) {
                        //$("#reservationsAdminReloadButton").removeAttr("disabled").find("[data-processing='true']").remove();
                    //});
                });
                $("#moderationBuildingSelect").change(function() {
                    let options = {};
                    let value = Number.parseInt($(this).val());
                    Object.assign(options, dataTablesModeratorOptions["reservations"]);
                    if (Number.parseInt($(this).attr("data-old")) >= 1 && value <= 0) {
                        options["rowGroup"] = {
                            dataSrc: "buildingid",
                            className: "bg-gray-200",
                            endRender: null,
                            startRender: function(rows, group) {
                                let index = buildings.findIndex(key => key["id"] === group);
                                return $("<tr>").append("<td colspan='7' class='align-middle' style='color: #282828'>" + (index >= 0 ? buildings[index]["name"] : "Unbekannte Gebäude-ID: " + group) + "</td>");
                            }
                        };
                        options["orderFixed"] = [1, "asc"];
                    }
                    options["destroy"] = true;
                    if (value >= 1) {
                        options["ajax"]["data"]["category"] = value;
                    }
                    else {
                        delete options["ajax"]["data"]["category"];
                    }
                    $(this).attr("data-old", value);
                    moderatorDataTables["reservations"] = $("#moderatorReservationTable").DataTable(options);
                });
                $("#myReservationStatusSelect").change(function() {
                    let options = {};
                    let value = Number.parseInt($(this).val());
                    Object.assign(options, dataTablesOptions["myReservations"]);
                    if (Number.parseInt($(this).attr("data-old")) >= 1 && value <= 0) {
                        options["rowGroup"] = {
                            dataSrc: "status",
                            className: "bg-gray-200",
                        };
                        options["orderFixed"] = [5, "asc"];
                    }
                    options["destroy"] = true;
                    if (value >= 1) {
                        options["ajax"]["data"]["category"] = value;
                    }
                    else {
                        delete options["ajax"]["data"]["category"];
                    }
                    $(this).attr("data-old", value);
                    $("#myReservationTable").off("draw.dt");
                    dataTables["myReservations"] = $("#myReservationTable").DataTable(options).on("draw.dt", function(settings) {
                        $("#myReservationsReloadButton").removeAttr("disabled").find("[data-processing='true']").remove();
                    });
                });
            });
        </script>
    </head>
    <body>
        <div id="body-overlay" class="m-0 p-0 overflow-hidden">
            <div class="spinner-border mr-2" style="border-width: 5px; color: var(--bs-gray-500)"></div>
        </div>
        <header>
            <nav class="navbar navbar-expand-sm p-0" id="navigation">
                <a class="navbar-brand ms-3 mb-0" href="#">
                    <div id="logo"></div>
                </a>
                <ul class="navbar-nav" id="first-navbar">
                    <li class="nav-item">
                        <a class="nav-link rounded-3" href="#systemInfos"><i class="fa-solid fa-hdd"></i> Systeminformationen</a>
                    </li>
                </ul>
                <ul class="navbar-nav mt-auto mb-auto ms-auto" id="second-navbar">
                    <li class="nav-item d-none">
                        <a class="nav-link rounded-3" href="#"><i class="fa-solid fa-sign-out-alt"></i> Abmelden</a>
                    </li>
                </ul>
                <div class="dropdown" id="mobile-navbar">
                    <button type="button" class="btn btn-outline-light dropdown-toggle" data-bs-toggle="dropdown" style="box-shadow: 0 0 1px 0 black">
                        <i class="fa-solid fa-bars"></i>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="#systemInfos"><i class="fa-solid fa-hdd"></i> Systeminformationen</a></li>
                        <li><div class="dropdown-divider"></div></li> 
                        <li><a class="dropdown-item" href="#login"><i class="fa-solid fa-sign-in-alt"></i> Anmelden</a></li>
                    </ul>
                </div> 
            </nav>
        </header>
        <main>
            <div class="row mt-4">
                <ul class="nav nav-tabs">
                    <li class="nav-item">
                        <a class="nav-link active" data-bs-toggle="tab" href="#reservationsOverview">Reservierungen</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-bs-toggle="tab" href="#moderation">Moderation</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-bs-toggle="tab" href="#administration">Administration</a>
                    </li>
                </ul>
                <div class="tab-content p-3">
                    <div class="tab-pane fade active show" id="reservationsOverview">
                        <ul class="nav nav-pills">
                            <li class="nav-item">
                                <a class="nav-link active" data-bs-toggle="pill" href="#calendar">Neue Reservierung</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-bs-toggle="pill" href="#myReservations">Meine Reservierungen</a>
                            </li>
                        </ul>
                        <div class="tab-content tab-content-simple">
                            <div class="tab-pane active pt-3" id="calendar">
                                <div class="row">
                                    <div class="col-md-8">
                                        <form enctype="text/plain" id="calendarLocationForm" method="post" action="/" class="w-100 d-flex formContainer mb-4 justify-content-center">
                                            <label for="buildingSelection" class="col-form-label me-2">Gebäude:</label>
                                            <select class="form-select w-auto d-inline-block" id="buildingSelection" required="required" onchange="loadRooms(this, '#roomSelection')"></select>
                                            <label for="roomSelection" class="col-form-label me-2">Raum:</label>
                                            <select class="form-select w-auto d-inline-block" id="roomSelection" required="required"></select>
                                            <button type="submit" class="btn btn-primary align-baseline" id="calendarLocationSubmit">Anzeigen</button>
                                        </form>
                                        <div id="reservationCalendar"></div>
                                    </div>
                                    <div class="col-md-4 align-self-end">
                                        <h4 class="col-md-12">Reservierungsdetails</h4>
                                        <div class="row">
                                            <div class="col-md-4">Beschreibung:</div>
                                            <div class="col-md-8" id="selectedReservationDescription"></div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-4">Start:</div>
                                            <div class="col-md-8" id="selectedReservationStart"></div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-4">Ende:</div>
                                            <div class="col-md-8" id="selectedReservationEnd"></div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-4">Organisator:</div>
                                            <div class="col-md-8" id="selectedReservationOrganiser"></div>
                                        </div>
                                        <!--
                                        <div class="row">
                                            <div class="col-md-4">Optionen:</div>
                                            <div class="col-md-8" id="selectedReservationOptions"></div>
                                        </div>
                                    -->
                                        <button type="button" class="btn btn-success mt-3 disabled" id="showReservationCreationModalButton" disabled="disabled" onclick="showReservationCreationModal()"><i class="fa-solid fa-plus"></i> Neue Reservierung</button>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane pt-3" id="myReservations">
                                <div class="alert-dismissible alert alert-primary alertBoxContainer" role="alert">
                                    <div class="alertBoxIcon primary">
                                        <i class="fa-solid fa-info-circle"></i>
                                    </div>
                                    <div class="alertBoxText">In dieser Tabelle werden alle Reservierungen der letzten 90 Tage angezeigt. Ältere Reservierungen werden aus datenschutzrechtlichen Gründen automatisch gelöscht.</div>
                                </div>
                                <div class="d-flex formContainer mb-3">
                                    <label for="myReservationStatusSelect" class="col-form-label me-2">Status:</label>
                                    <select class="form-select w-auto d-inline-block" id="myReservationStatusSelect" data-old="0">
                                        <option value="0" selected="selected">Alle</option>
                                        <option value="1">Beantragt</option>
                                        <option value="2">Genehmigt</option>
                                        <option value="3">Abgelehnt</option>
                                    </select>
                                </div>
                                <table class="table table-sm mt-3 w-100" id="myReservationTable">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Raum</th>
                                            <th>Start</th>
                                            <th>Ende</th>
                                            <th>Beschreibung</th>
                                            <th>Status</th>
                                            <!--<th>Optionen</th>-->
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                                <div class="d-flex formContainer justify-content-end mt-3" id="myReservationsActions">
                                    <button class="btn btn-primary" id="myReservationsReloadButton" onclick="reloadDataTableData(this, '#myReservationTable')"><i class="fa-solid fa-arrows-rotate"></i> Aktualisieren</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="moderation">
                        <div class="alert-dismissible alert alert-primary alertBoxContainer" role="alert">
                            <div class="alertBoxIcon primary">
                                <i class="fa-solid fa-info-circle"></i>
                            </div>
                            <div class="alertBoxText">In diesem Bereich werden eingehende Reservierungen genehmigt oder abgelehnt.</div>
                        </div>
                        <div class="d-flex formContainer mb-3">
                            <label for="moderationBuildingSelect" class="col-form-label me-2">Gebäude:</label>
                            <select class="form-select w-auto d-inline-block" id="moderationBuildingSelect" data-old="0">
                                <option value="0">Alle</option>
                            </select>
                        </div>
                        <table class="table table-sm mt-3 w-100" id="moderatorReservationTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Bucher</th>
                                    <th>Raum</th>
                                    <th>Gebäude</th>
                                    <th>Start</th>
                                    <th>Ende</th>
                                    <th>Beschreibung</th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th>Optionen</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                        <div class="d-flex formContainer justify-content-end mt-3" id="reservationsModeratorActions">
                            <button class="btn btn-primary" id="reservationsModeratorReloadButton" onclick="reloadDataTableData(this, '#moderatorReservationTable')"><i class="fa-solid fa-arrows-rotate"></i> Aktualisieren</button>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="administration">
                        <div id="reservation-accordion" class="mb-3">
                            <div class="card">
                                <div class="card-header p-0">
                                    <a class="btn d-flex align-items-center" data-bs-toggle="collapse" href="#collapse-reservations">
                                        <h4 class="ms-0 mt-auto me-auto mb-auto"><i class="fa-regular fa-calendar-days"></i> Reservierungen</h4>
                                        <i class="fa-solid fa-chevron-down ms-auto mt-auto me-2 mb-auto"></i>
                                    </a>
                                </div>
                                <div id="collapse-reservations" class="collapse hide" data-bs-parent="#reservation-accordion" data-admin-table="reservations">
                                    <div class="card-body">
                                        <div class="d-flex formContainer mb-3">
                                            <label for="reservationBuildingSelect" class="col-form-label me-2">Gebäude:</label>
                                            <select class="form-select w-auto d-inline-block" id="reservationBuildingSelect" data-old="0"></select>
                                        </div>
                                        <table class="table table-sm w-100 mt-3" id="reservationAdminTable">
                                            <thead>
                                                <tr>
                                                    <th>ID</th>
                                                    <th>Bucher</th>
                                                    <th>Raum</th>
                                                    <th>Gebäude</th>
                                                    <th>Start</th>
                                                    <th>Ende</th>
                                                    <th>Beschreibung</th>
                                                    <th>Status</th>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                    <th>Optionen</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>
                                        <div class="d-flex formContainer justify-content-end mt-3" id="reservationsActions">
                                            <button class="btn btn-primary" id="reservationsAdminReloadButton" onclick="reloadDataTableData(this, '#reservationAdminTable')"><i class="fa-solid fa-arrows-rotate"></i> Aktualisieren</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="buildings-accordion" class="mb-3">
                            <div class="card">
                                <div class="card-header p-0">
                                    <a class="btn d-flex align-items-center" data-bs-toggle="collapse" href="#collapse-buildings" data-admin-table="buildings">
                                        <h4 class="ms-0 mt-auto me-auto mb-auto"><i class="fa-solid fa-building"></i> Gebäude</h4>
                                        <i class="fa-solid fa-chevron-down ms-auto mt-auto me-2 mb-auto"></i>
                                    </a>
                                </div>
                                <div id="collapse-buildings" class="collapse hide" data-bs-parent="#buildings-accordion">
                                    <div class="card-body">
                                        <table class="table table-sm w-100 mt-3" id="buildingsAdminTable">
                                            <thead>
                                                <tr>
                                                    <th>ID</th>
                                                    <th>Name</th>
                                                    <th>Beschreibung</th>
                                                    <th>Optionen</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>
                                        <div class="d-flex formContainer justify-content-end mt-3" id="buildingsAdminActions">
                                            <button class="btn btn-primary" id="buildingsAdminReloadButton" onclick="reloadDataTableData(this, '#buildingsAdminTable')"><i class="fa-solid fa-arrows-rotate"></i> Aktualisieren</button>
                                            <button class='btn btn-success' onclick='showBuildingCreationModal()'><i class='fa-solid fa-asterisk'></i> Neu...</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="rooms-accordion" class="mb-3">
                            <div class="card">
                                <div class="card-header p-0">
                                    <a class="btn d-flex align-items-center" data-bs-toggle="collapse" href="#collapse-rooms" data-admin-table="rooms">
                                        <h4 class="ms-0 mt-auto me-auto mb-auto"><i class="fa-solid fa-door-open"></i> Räume</h4>
                                        <i class="fa-solid fa-chevron-down ms-auto mt-auto me-2 mb-auto"></i>
                                    </a>
                                </div>
                                <div id="collapse-rooms" class="collapse hide" data-bs-parent="#rooms-accordion">
                                    <div class="card-body">
                                        <div class="d-flex formContainer mb-3">
                                            <label for="roomsBuildingSelect" class="col-form-label me-2">Gebäude:</label>
                                            <select class="form-select w-auto d-inline-block" id="roomsBuildingSelect" data-old="0">
                                                <option value="0">Alle</option>
                                            </select>
                                        </div>
                                        <table class="table table-sm w-100 mt-3" id="roomsAdminTable">
                                            <thead>
                                                <tr>
                                                    <th>ID</th>
                                                    <th>Gebäude</th>
                                                    <th>Name</th>
                                                    <th>Beschreibung</th>
                                                    <th>Optionen</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>
                                        <div class="d-flex formContainer justify-content-end mt-3" id="roomsAdminActions">
                                            <button class="btn btn-primary" id="roomsAdminReloadButton" onclick="reloadDataTableData(this, '#roomsAdminTable')"><i class="fa-solid fa-arrows-rotate"></i> Aktualisieren</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="logs-accordion">
                            <div class="card">
                                <div class="card-header p-0">
                                    <a class="btn d-flex align-items-center" data-bs-toggle="collapse" href="#collapse-logs" data-table="logs">
                                        <h4 class="ms-0 mt-auto me-auto mb-auto"><i class="fas fa-scroll"></i> Logs</h4>
                                        <i class="fas fa-chevron-down ms-auto mt-auto me-2 mb-auto"></i>
                                    </a>
                                </div>
                                <div id="collapse-logs" class="collapse hide" data-bs-parent="#logs-accordion">
                                    <div class="card-body">
                                        <table class="table table-sm w-100 mt-3" id="logsAdminTable">
                                            <thead>
                                                <tr>
                                                    <th>ID</th>
                                                    <th>Zeitpunkt</th>
                                                    <th>Typ</th>
                                                    <th>Nachricht</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>
                                        <div class="d-flex formContainer justify-content-end mt-3" id="logsAdminActions">
                                            <button class="btn btn-primary" id="logsAdminReloadButton" onclick="reloadDataTableData(this, '#logsAdminTable')"><i class="fa-solid fa-arrows-rotate"></i> Aktualisieren</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        <footer></footer>
        <div class="modal fade" id="mainModal">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title"></h4>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body"></div>
                    <div class="modal-footer"></div>
                </div>
            </div>
        </div>
    </body>
</html>